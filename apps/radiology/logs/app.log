[2023-02-18 11:28:33,441] [95030] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-02-18 11:28:33,577] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 11:28:33,587] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 11:28:33,587] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 11:28:33,590] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 11:28:33,591] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 11:28:33,592] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 11:28:33,592] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 11:28:33,593] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 11:28:33,594] [95030] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 11:28:33,594] [95030] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-02-18 11:28:33,594] [95030] [MainThread] [INFO] (monailabel.utils.others.generic:184) - Downloading resource: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology/model/pretrained_segmentation_spleen.pt from https://github.com/Project-MONAI/MONAILabel/releases/download/pretrained/radiology_segmentation_unet_spleen.pt
[2023-02-18 11:28:40,687] [95030] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-02-18 11:28:40,687] [95030] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-02-18 11:28:40,687] [95030] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-02-18 11:28:40,687] [95030] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-02-18 11:28:43,525] [95030] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-02-18 11:28:43,525] [95030] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-02-18 11:28:43,525] [95030] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-02-18 11:28:43,526] [95030] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 11:28:43,526] [95030] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-02-18 11:28:43,526] [95030] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f933ea23430>
[2023-02-18 11:28:43,527] [95030] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f933ea23430>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f933ea23ca0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f933ea25ca0>}
[2023-02-18 11:28:43,527] [95030] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f933ea25ac0>
[2023-02-18 11:28:43,527] [95030] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-02-18 11:28:43,527] [95030] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-02-18 11:28:43,527] [95030] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-02-18 11:28:43,527] [95030] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-02-18 11:28:43,527] [95030] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f933e981ca0>
[2023-02-18 11:28:43,527] [95030] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-02-18 12:15:05,780] [100973] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {}
[2023-02-18 12:15:05,898] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 12:15:05,900] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 12:15:05,900] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 12:15:05,901] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 12:15:05,901] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 12:15:05,902] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 12:15:05,902] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 12:15:05,902] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 12:15:05,902] [100973] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 12:16:41,161] [101043] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {}
[2023-02-18 12:16:41,256] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 12:16:41,258] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 12:16:41,258] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 12:16:41,259] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 12:16:41,259] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 12:16:41,259] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 12:16:41,260] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 12:16:41,260] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 12:16:41,260] [101043] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 12:17:50,108] [101134] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {}
[2023-02-18 12:17:50,203] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 12:17:50,205] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 12:17:50,205] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 12:17:50,206] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 12:17:50,206] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 12:17:50,206] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 12:17:50,206] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 12:17:50,206] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 12:17:50,207] [101134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 12:18:27,444] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-02-18 12:18:27,547] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 12:18:27,549] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 12:18:27,550] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 12:18:27,550] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 12:18:27,550] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 12:18:27,551] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 12:18:27,551] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 12:18:27,551] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 12:18:27,551] [101256] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 12:18:27,551] [101256] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-02-18 12:18:27,588] [101256] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-02-18 12:18:27,588] [101256] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-02-18 12:18:27,588] [101256] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-02-18 12:18:27,588] [101256] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-02-18 12:18:27,589] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-02-18 12:18:27,589] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-02-18 12:18:27,589] [101256] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-02-18 12:18:27,589] [101256] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 12:18:27,590] [101256] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-02-18 12:18:27,590] [101256] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f3e08c43910>
[2023-02-18 12:18:27,590] [101256] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f3e08c43910>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f3e08c438b0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f3e08c62820>}
[2023-02-18 12:18:27,590] [101256] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f3e08c62880>
[2023-02-18 12:18:27,591] [101256] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-02-18 12:18:27,591] [101256] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-02-18 12:18:27,591] [101256] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-02-18 12:18:27,591] [101256] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-02-18 12:18:27,591] [101256] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f3e09974940>
[2023-02-18 12:18:27,591] [101256] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-02-18 12:18:44,724] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 12:18:44,733] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 13:41:38,940] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 13:41:38,948] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 13:41:45,153] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:41:45,154] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:41:45,154] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 13:41:45,176] [101256] [MainThread] [INFO] (dicomweb_client.web:2246) - retrieve series "1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053" of study "1.3.6.1.4.1.14519.5.2.1.3023.4012.168302478574661582991726083511"
[2023-02-18 13:41:45,214] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:111) - Time to download: 0.059739112854003906 (sec)
[2023-02-18 13:41:45,259] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:56) - Image size: (512, 512, 1)
[2023-02-18 13:41:45,297] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:60) - dicom_to_nifti latency : 0.08231592178344727 (sec)
[2023-02-18 13:41:45,297] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 13:41:45,302] [101256] [MainThread] [INFO] (monailabel.datastore.local:438) - Adding Image: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053 => /tmp/tmpsjpu2fwc.nii.gz
[2023-02-18 13:41:45,310] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 1])
[2023-02-18 13:41:45,310] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (262144,)
[2023-02-18 13:41:45,310] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 1)
[2023-02-18 13:41:45,576] [101256] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 13:41:45,579] [101256] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 13:41:47,173] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 1.8696622848510742 (sec)
[2023-02-18 13:41:47,174] [101256] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'Histogram+GraphCut', 'image': '1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053', 'label': '/tmp/tmpmkmbl75i.nii.gz', 'num_bins': 64, 'lamda': 1, 'sigma': 0.1, 'device': ['cpu'], 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-02-18 13:41:47,174] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:41:47,174] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:41:47,174] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'num_bins': 64, 'lamda': 1, 'sigma': 0.1, 'device': 'cpu', 'model': 'Histogram+GraphCut', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053.nii.gz', 'label': '/tmp/tmpmkmbl75i.nii.gz', 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A post processing step with histogram-based GraphCut for Generic segmentation'}
[2023-02-18 13:41:47,175] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-02-18 13:41:47,176] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-02-18 13:41:47,180] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.0047; image: torch.Size([512, 512, 1])(torch.float32); label: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:41:47,182] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0014; image: torch.Size([1, 512, 512, 1])(torch.float32); label: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:41:47,182] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:41:47,182] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:41:47,182] [101256] [MainThread] [INFO] (monailabel.scribbles.transforms:121) - Scribbles: (1, 512, 512, 1)
[2023-02-18 13:41:47,184] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (AddBackgroundScribblesFromROId): Time: 0.0015; image: torch.Size([1, 512, 512, 1])(torch.float32); label: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:41:47,201] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.0177; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:41:47,202] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0009; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:41:47,203] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => Compose => {'transforms': (<monailabel.scribbles.transforms.MakeLikelihoodFromScribblesHistogramd object at 0x7f3dd82b5a00>,), 'map_items': True, 'unpack_items': False, 'log_stats': False, 'R': RandomState(MT19937) at 0x7F3DD828D240}
[2023-02-18 13:41:47,203] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: None
[2023-02-18 13:41:47,203] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INF - Run Inferer(s)
[2023-02-18 13:41:47,203] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INF - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'label_meta_dict', 'latencies']
[2023-02-18 13:41:47,203] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:41:47,203] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:41:47,204] [101256] [MainThread] [INFO] (monailabel.scribbles.transforms:57) - found non normalized logits, normalizing using Softmax
[2023-02-18 13:41:47,205] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INF - Inferer (MakeLikelihoodFromScribblesHistogramd): Time: 0.0015; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:41:47,205] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2023-02-18 13:41:47,205] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'label_meta_dict', 'latencies', 'prob_meta_dict', 'prob']
[2023-02-18 13:41:47,205] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:41:47,205] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:41:47,206] [101256] [MainThread] [INFO] (root:66) - warning: no background scribbles received with label 2, available in scribbles [0.]
[2023-02-18 13:41:47,206] [101256] [MainThread] [INFO] (root:73) - warning: no foreground scribbles received with label 3, available in scribbles [0.]
[2023-02-18 13:41:47,206] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (MakeISegUnaryd): Time: 0.001; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:41:47,207] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (ApplyGraphCutOptimisationd): Time: 0.0009; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32); pred: (1, 113, 113, 1)(float32)
[2023-02-18 13:41:47,209] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0019; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32); pred: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:41:47,210] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (BoundingBoxd): Time: 0.0012; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32); pred: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:41:47,211] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:571) - Writing Result...
[2023-02-18 13:41:47,211] [101256] [MainThread] [INFO] (monailabel.transform.writer:189) - Result ext: .nrrd; write_to_file: True; dtype: uint16
[2023-02-18 13:41:47,213] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:334) - ++ Latencies => Total: 0.0389; Pre: 0.0284; Inferer: 0.0022; Invert: 0.0000; Post: 0.0058; Write: 0.0022
[2023-02-18 13:41:47,213] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:358) - Result File: /tmp/tmp17v89vrf.nrrd
[2023-02-18 13:41:47,213] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:359) - Result Json Keys: ['bbox', 'label_names', 'latencies']
[2023-02-18 13:41:56,987] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:41:56,988] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:41:56,993] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 1])
[2023-02-18 13:41:56,993] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (262144,)
[2023-02-18 13:41:56,993] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 1)
[2023-02-18 13:41:56,995] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 0.0074651241302490234 (sec)
[2023-02-18 13:41:56,995] [101256] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'GMM+GraphCut', 'image': '1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053', 'label': '/tmp/tmp7sp70f15.nii.gz', 'num_mixtures': 20, 'lamda': 5, 'sigma': 0.5, 'device': ['cpu'], 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-02-18 13:41:56,995] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:41:56,996] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:41:56,996] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'num_mixtures': 20, 'lamda': 5, 'sigma': 0.5, 'device': 'cpu', 'model': 'GMM+GraphCut', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053.nii.gz', 'label': '/tmp/tmp7sp70f15.nii.gz', 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A post processing step with GMM-based GraphCut for Generic segmentation'}
[2023-02-18 13:41:56,996] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-02-18 13:41:56,996] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['num_mixtures', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-02-18 13:41:57,003] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.0059; image: torch.Size([512, 512, 1])(torch.float32); label: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:41:57,003] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0002; image: torch.Size([1, 512, 512, 1])(torch.float32); label: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:41:57,003] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:41:57,003] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:41:57,003] [101256] [MainThread] [INFO] (monailabel.scribbles.transforms:121) - Scribbles: (1, 512, 512, 1)
[2023-02-18 13:41:57,004] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (AddBackgroundScribblesFromROId): Time: 0.0007; image: torch.Size([1, 512, 512, 1])(torch.float32); label: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:41:57,009] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.005; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:41:57,009] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0002; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:41:57,009] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => Compose => {'transforms': (<monailabel.scribbles.transforms.MakeLikelihoodFromScribblesGMMd object at 0x7f3dc66634c0>,), 'map_items': True, 'unpack_items': False, 'log_stats': False, 'R': RandomState(MT19937) at 0x7F3DD828D240}
[2023-02-18 13:41:57,009] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: None
[2023-02-18 13:41:57,010] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INF - Run Inferer(s)
[2023-02-18 13:41:57,010] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INF - Input Keys: ['num_mixtures', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'label_meta_dict', 'latencies']
[2023-02-18 13:41:57,010] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:41:57,010] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:42:00,752] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:42:00,753] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:42:00,758] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 1])
[2023-02-18 13:42:00,758] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (262144,)
[2023-02-18 13:42:00,758] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 1)
[2023-02-18 13:42:00,760] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 0.007055044174194336 (sec)
[2023-02-18 13:42:00,760] [101256] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'GMM+GraphCut', 'image': '1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053', 'label': '/tmp/tmp38404ecq.nii.gz', 'num_mixtures': 20, 'lamda': 5, 'sigma': 0.5, 'device': ['cpu'], 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-02-18 13:42:00,760] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:42:00,760] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:42:00,760] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'num_mixtures': 20, 'lamda': 5, 'sigma': 0.5, 'device': 'cpu', 'model': 'GMM+GraphCut', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053.nii.gz', 'label': '/tmp/tmp38404ecq.nii.gz', 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A post processing step with GMM-based GraphCut for Generic segmentation'}
[2023-02-18 13:42:00,761] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-02-18 13:42:00,761] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['num_mixtures', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-02-18 13:42:00,767] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.0062; image: torch.Size([512, 512, 1])(torch.float32); label: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:42:00,767] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0001; image: torch.Size([1, 512, 512, 1])(torch.float32); label: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:42:00,767] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:42:00,767] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:42:00,768] [101256] [MainThread] [INFO] (monailabel.scribbles.transforms:121) - Scribbles: (1, 512, 512, 1)
[2023-02-18 13:42:00,768] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (AddBackgroundScribblesFromROId): Time: 0.0008; image: torch.Size([1, 512, 512, 1])(torch.float32); label: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:42:00,773] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.0043; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:42:00,773] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0002; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:42:00,773] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => Compose => {'transforms': (<monailabel.scribbles.transforms.MakeLikelihoodFromScribblesGMMd object at 0x7f3e082f8d60>,), 'map_items': True, 'unpack_items': False, 'log_stats': False, 'R': RandomState(MT19937) at 0x7F3DD828DC40}
[2023-02-18 13:42:00,773] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: None
[2023-02-18 13:42:00,774] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INF - Run Inferer(s)
[2023-02-18 13:42:00,774] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INF - Input Keys: ['num_mixtures', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'label_meta_dict', 'latencies']
[2023-02-18 13:42:00,774] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:42:00,774] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:42:22,503] [101256] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'segmentation_spleen', 'image': '1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053', 'device': ['cpu'], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-02-18 13:42:22,503] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:42:22,503] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:42:22,503] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'device': 'cpu', 'model': 'segmentation_spleen', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A pre-trained model for volumetric (3D) segmentation of the spleen from CT image'}
[2023-02-18 13:42:22,503] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-02-18 13:42:22,503] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-02-18 13:42:22,507] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.0038; image: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:42:22,508] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:42:22,508] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0001; image: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:42:22,513] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.0052; image: torch.Size([1, 280, 280, 1])(torch.float32)
[2023-02-18 13:42:22,513] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0003; image: torch.Size([1, 280, 280, 1])(torch.float32)
[2023-02-18 13:42:22,513] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => SlidingWindowInferer => {'roi_size': (160, 160, 160), 'sw_batch_size': 1, 'overlap': 0.25, 'mode': constant, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'roi_weight_map': None}
[2023-02-18 13:42:22,514] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology/model/pretrained_segmentation_spleen.pt
[2023-02-18 13:42:24,230] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2023-02-18 13:42:24,230] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'latencies', 'pred']
[2023-02-18 13:42:24,230] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 280, 280, 1])(torch.float32); pred: torch.Size([2, 280, 280, 1])(torch.float32)
[2023-02-18 13:42:24,240] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0097; image: torch.Size([1, 280, 280, 1])(torch.float32); pred: torch.Size([2, 280, 280, 1])(torch.float32)
[2023-02-18 13:42:24,246] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0059; image: torch.Size([1, 280, 280, 1])(torch.float32); pred: torch.Size([1, 280, 280, 1])(torch.float32)
[2023-02-18 13:42:24,247] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0009; image: torch.Size([1, 280, 280, 1])(torch.float32); pred: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:42:24,249] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:571) - Writing Result...
[2023-02-18 13:42:24,250] [101256] [MainThread] [INFO] (monailabel.transform.writer:189) - Result ext: .nrrd; write_to_file: True; dtype: uint16
[2023-02-18 13:42:24,252] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:334) - ++ Latencies => Total: 1.7492; Pre: 0.0104; Inferer: 1.7159; Invert: 0.0000; Post: 0.0200; Write: 0.0026
[2023-02-18 13:42:24,252] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:358) - Result File: /tmp/tmpd1szqog5.nrrd
[2023-02-18 13:42:24,252] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:359) - Result Json Keys: ['label_names', 'latencies']
[2023-02-18 13:43:13,968] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:43:13,968] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:43:13,972] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 1])
[2023-02-18 13:43:13,972] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (262144,)
[2023-02-18 13:43:13,972] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 1)
[2023-02-18 13:43:13,974] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 0.006082296371459961 (sec)
[2023-02-18 13:43:13,974] [101256] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'Histogram+GraphCut', 'image': '1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053', 'label': '/tmp/tmpdbhq9emu.nii.gz', 'num_bins': 64, 'lamda': 1, 'sigma': 0.1, 'device': ['cpu'], 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-02-18 13:43:13,974] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:43:13,974] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053
[2023-02-18 13:43:13,974] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'num_bins': 64, 'lamda': 1, 'sigma': 0.1, 'device': 'cpu', 'model': 'Histogram+GraphCut', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.297267439816180432188742253053.nii.gz', 'label': '/tmp/tmpdbhq9emu.nii.gz', 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A post processing step with histogram-based GraphCut for Generic segmentation'}
[2023-02-18 13:43:13,975] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-02-18 13:43:13,975] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-02-18 13:43:13,980] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.0052; image: torch.Size([512, 512, 1])(torch.float32); label: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:43:13,981] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0001; image: torch.Size([1, 512, 512, 1])(torch.float32); label: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:43:13,981] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:43:13,981] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:43:13,981] [101256] [MainThread] [INFO] (monailabel.scribbles.transforms:121) - Scribbles: (1, 512, 512, 1)
[2023-02-18 13:43:13,981] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (AddBackgroundScribblesFromROId): Time: 0.0005; image: torch.Size([1, 512, 512, 1])(torch.float32); label: torch.Size([1, 512, 512, 1])(torch.float32)
[2023-02-18 13:43:13,985] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.0043; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:43:13,986] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0002; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:43:13,986] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => Compose => {'transforms': (<monailabel.scribbles.transforms.MakeLikelihoodFromScribblesHistogramd object at 0x7f3dc6541dc0>,), 'map_items': True, 'unpack_items': False, 'log_stats': False, 'R': RandomState(MT19937) at 0x7F3DD828D940}
[2023-02-18 13:43:13,986] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: None
[2023-02-18 13:43:13,986] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INF - Run Inferer(s)
[2023-02-18 13:43:13,986] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INF - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'label_meta_dict', 'latencies']
[2023-02-18 13:43:13,987] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:43:13,987] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:43:13,988] [101256] [MainThread] [INFO] (monailabel.scribbles.transforms:57) - found non normalized logits, normalizing using Softmax
[2023-02-18 13:43:13,988] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INF - Inferer (MakeLikelihoodFromScribblesHistogramd): Time: 0.0012; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:43:13,988] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2023-02-18 13:43:13,988] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'label_meta_dict', 'latencies', 'prob_meta_dict', 'prob']
[2023-02-18 13:43:13,988] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 13:43:13,989] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 13:43:13,989] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (MakeISegUnaryd): Time: 0.0006; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32)
[2023-02-18 13:43:13,994] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (ApplyGraphCutOptimisationd): Time: 0.0044; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32); pred: (1, 113, 113, 1)(float32)
[2023-02-18 13:43:13,995] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0011; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32); pred: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:43:13,996] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (BoundingBoxd): Time: 0.0008; image: torch.Size([1, 113, 113, 1])(torch.float32); label: torch.Size([1, 113, 113, 1])(torch.float32); pred: torch.Size([512, 512, 1])(torch.float32)
[2023-02-18 13:43:13,996] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:571) - Writing Result...
[2023-02-18 13:43:13,996] [101256] [MainThread] [INFO] (monailabel.transform.writer:189) - Result ext: .nrrd; write_to_file: True; dtype: uint16
[2023-02-18 13:43:13,998] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:334) - ++ Latencies => Total: 0.0240; Pre: 0.0114; Inferer: 0.0020; Invert: 0.0000; Post: 0.0080; Write: 0.0024
[2023-02-18 13:43:13,998] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:358) - Result File: /tmp/tmp52ns35fc.nrrd
[2023-02-18 13:43:13,998] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:359) - Result Json Keys: ['bbox', 'label_names', 'latencies']
[2023-02-18 14:41:01,122] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:41:01,268] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:45:01,876] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:45:02,028] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:45:17,702] [101256] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-02-18 14:45:17,709] [101256] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/MONAILabel:
[2023-02-18 14:45:17,709] [101256] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/MONAILabel:
[2023-02-18 14:45:17,709] [101256] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_spleen","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-02-18 14:45:17,951] [108583] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-02-18 14:45:20,016] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 14:45:20,019] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 14:45:20,019] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 14:45:20,020] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 14:45:20,020] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 14:45:20,020] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 14:45:20,021] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 14:45:20,021] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 14:45:20,021] [108583] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 14:45:20,021] [108583] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-02-18 14:45:20,069] [108583] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-02-18 14:45:20,069] [108583] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-02-18 14:45:20,069] [108583] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-02-18 14:45:20,069] [108583] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-02-18 14:45:20,069] [108583] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-02-18 14:45:20,069] [108583] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-02-18 14:45:20,070] [108583] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-02-18 14:45:20,071] [108583] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 14:45:20,071] [108583] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-02-18 14:45:20,072] [108583] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fa8c47938e0>
[2023-02-18 14:45:20,072] [108583] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fa8c47938e0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fa8c4793880>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fa8c4732850>}
[2023-02-18 14:45:20,072] [108583] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fa8c47328b0>
[2023-02-18 14:45:20,072] [108583] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-02-18 14:45:20,072] [108583] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-02-18 14:45:20,072] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-02-18 14:45:20,072] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-02-18 14:45:20,072] [108583] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:45:20,076] [108583] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-02-18 14:45:20,076] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-02-18 14:45:20,076] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-02-18 14:45:20,076] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_spleen', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230218_144520'}
[2023-02-18 14:45:20,076] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-02-18 14:45:20,077] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology/model/segmentation_spleen/train_01
[2023-02-18 14:45:20,077] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-02-18 14:45:20,077] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology/model/segmentation_spleen/train_01/mlruns;
[2023-02-18 14:45:20,077] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_spleen; Run Name: run_20230218_144520
[2023-02-18 14:45:20,077] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-02-18 14:45:20,077] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-02-18 14:45:20,080] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology/model/pretrained_segmentation_spleen.pt
[2023-02-18 14:45:20,080] [108583] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/MONAILabel/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/MONAILabel/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/MONAILabel/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/MONAILabel/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/MONAILabel/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/MONAILabel/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/MONAILabel/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/MONAILabel/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
[2023-02-18 14:45:20,450] [101256] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-02-18 14:45:26,536] [101256] [MainThread] [INFO] (monailabel.utils.async_tasks.utils:120) - Kill background task for train
[2023-02-18 14:45:32,506] [101256] [MainThread] [INFO] (monailabel.endpoints.activelearning:43) - Active Learning Request: {'strategy': 'random'}
[2023-02-18 14:45:32,506] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:170) - Total Series (with seg): 0

[2023-02-18 14:45:32,507] [101256] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734; Weight: 1676706332
[2023-02-18 14:45:32,507] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734
[2023-02-18 14:45:32,507] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734
[2023-02-18 14:45:32,508] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:45:32,524] [101256] [MainThread] [INFO] (dicomweb_client.web:2246) - retrieve series "1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734" of study "1.3.6.1.4.1.14519.5.2.1.3023.4012.153602188520630088008272568572"
[2023-02-18 14:45:32,573] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:111) - Time to download: 0.06570267677307129 (sec)
[2023-02-18 14:45:32,585] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:56) - Image size: (512, 512, 1)
[2023-02-18 14:45:32,607] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:60) - dicom_to_nifti latency : 0.03325510025024414 (sec)
[2023-02-18 14:45:32,607] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:45:32,612] [101256] [MainThread] [INFO] (monailabel.datastore.local:438) - Adding Image: 1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734 => /tmp/tmppb6w923r.nii.gz
[2023-02-18 14:45:32,614] [101256] [MainThread] [INFO] (monailabel.endpoints.activelearning:59) - Next sample: {'id': '1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734', 'weight': 1676706332, 'path': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734.nii.gz', 'SeriesInstanceUID': '1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734', 'StudyDate': '19970320', 'StudyTime': '114932.000000', 'Modality': 'CT', 'RetrieveURL': 'http://127.0.0.1/dicom-web/studies/1.3.6.1.4.1.14519.5.2.1.3023.4012.153602188520630088008272568572/series/1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734', 'PatientID': 'TCGA-60-2715', 'StudyInstanceUID': '1.3.6.1.4.1.14519.5.2.1.3023.4012.153602188520630088008272568572', 'ts': 1676706332, 'name': '1.3.6.1.4.1.14519.5.2.1.3023.4012.154470741269083988898569715734.nii.gz'}
[2023-02-18 14:45:32,666] [101256] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 14:49:14,863] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:49:15,000] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:49:15,002] [101256] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-02-18 14:49:15,003] [101256] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/MONAILabel:
[2023-02-18 14:49:15,003] [101256] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/MONAILabel:
[2023-02-18 14:49:15,003] [101256] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_spleen","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-02-18 14:49:15,151] [108853] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-02-18 14:49:15,692] [101256] [MainThread] [INFO] (monailabel.utils.async_tasks.utils:120) - Kill background task for train
[2023-02-18 14:49:15,698] [101256] [MainThread] [INFO] (monailabel.utils.async_tasks.utils:129) - Kill:: Process pid is 108853
[2023-02-18 14:49:15,698] [101256] [MainThread] [INFO] (monailabel.utils.async_tasks.utils:133) - Killed background process: 108853
[2023-02-18 14:49:15,710] [101256] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: -9
[2023-02-18 14:50:03,714] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-02-18 14:50:03,801] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[214,131,230,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"generic","description":"generic tissue seg"}]}
[2023-02-18 14:50:03,801] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:03,801] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmpyfjal35m.bin
[2023-02-18 14:50:03,801] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-02-18 14:50:03,802] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}]}
[2023-02-18 14:50:03,802] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:03,802] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:03,802] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:50:03,807] [101256] [MainThread] [INFO] (dicomweb_client.web:2246) - retrieve series "1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423" of study "1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408"
[2023-02-18 14:50:11,650] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:111) - Time to download: 7.848377466201782 (sec)
[2023-02-18 14:50:11,955] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:56) - Image size: (512, 512, 301)
[2023-02-18 14:50:20,675] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:60) - dicom_to_nifti latency : 9.021420955657959 (sec)
[2023-02-18 14:50:20,681] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:50:20,685] [101256] [MainThread] [INFO] (monailabel.datastore.local:438) - Adding Image: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => /tmp/tmpamlh1wh3.nii.gz
[2023-02-18 14:50:20,848] [101256] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 14:50:23,535] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-02-18 14:50:23,535] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-02-18 14:50:23,535] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-02-18 14:50:23,684] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.936511993408203 (sec)
[2023-02-18 14:50:23,692] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmp1d6_w83x.nii.gz
[2023-02-18 14:50:26,430] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    []
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-02-18 14:50:26,430] [101256] [MainThread] [ERROR] (monailabel.datastore.utils.convert:143) - Missing Attributes/Empty Label provided
[2023-02-18 14:50:26,990] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-02-18 14:50:27,083] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[214,131,230,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"generic","description":"generic tissue seg"}]}
[2023-02-18 14:50:27,083] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:27,083] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmphsk2x22_.bin
[2023-02-18 14:50:27,083] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-02-18 14:50:27,083] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}]}
[2023-02-18 14:50:27,083] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:27,083] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:29,462] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-02-18 14:50:29,462] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-02-18 14:50:29,462] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-02-18 14:50:29,635] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.551819086074829 (sec)
[2023-02-18 14:50:29,644] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmplqvpi2yh.nii.gz
[2023-02-18 14:50:32,604] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    []
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-02-18 14:50:32,605] [101256] [MainThread] [ERROR] (monailabel.datastore.utils.convert:143) - Missing Attributes/Empty Label provided
[2023-02-18 14:50:32,761] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-02-18 14:50:32,873] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[214,131,230,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"generic","description":"generic tissue seg"}]}
[2023-02-18 14:50:32,873] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:32,873] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmpwa3ywkgm.bin
[2023-02-18 14:50:32,873] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-02-18 14:50:32,873] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}]}
[2023-02-18 14:50:32,873] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:32,874] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:35,242] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-02-18 14:50:35,242] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-02-18 14:50:35,242] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-02-18 14:50:35,359] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.485198974609375 (sec)
[2023-02-18 14:50:35,366] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmp1r_aggvn.nii.gz
[2023-02-18 14:50:38,116] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 3 => generic
[2023-02-18 14:50:38,116] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 3,
        "SegmentLabel": "generic",
        "SegmentDescription": "generic tissue seg",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "generic"
        },
        "recommendedDisplayRGBValue": [
          214,
          131,
          230
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-02-18 14:50:38,118] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmp1r_aggvn.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmp30vasyqd.dcm --inputMetadata /tmp/tmp4bhgeal2.json
[2023-02-18 14:50:38,157] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-02-18 14:50:38,435] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-02-18 14:50:38,455] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-02-18 14:50:38,483] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-02-18 14:50:38,525] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-02-18 14:50:38,525] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 3
[2023-02-18 14:50:38,525] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 3 is 301
[2023-02-18 14:50:38,525] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-02-18 14:50:38,525] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to generic
[2023-02-18 14:50:38,735] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmp30vasyqd.dcm
[2023-02-18 14:50:38,743] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-02-18 14:50:38,744] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.3772449493408203 (sec)
[2023-02-18 14:50:38,846] [101256] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-02-18 14:50:38,925] [101256] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-02-18 14:50:39,033] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - ISO_IR 100
[2023-02-18 14:50:39,033] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - http://127.0.0.1/dicom-web/studies/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408
[2023-02-18 14:50:39,033] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-02-18 14:50:39,033] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - [(0008, 1150) Referenced SOP Class UID            UI: Segmentation Storage
(0008, 1155) Referenced SOP Instance UID         UI: 1.2.276.0.7230010.3.1.4.225842493.108979.1676706638.453907
(0008, 1190) Retrieve URL                        UR: 'http://127.0.0.1/dicom-web/studies/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408/series/1.2.276.0.7230010.3.1.3.225842493.108979.1676706638.453906/instances/1.2.276.0.7230010.3.1.4.225842493.108979.1676706638.453907']
[2023-02-18 14:50:39,033] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:128) - Series Instance UID: 1.2.276.0.7230010.3.1.3.225842493.108979.1676706638.453906
[2023-02-18 14:50:39,033] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:130) - Time to upload: 0.28874754905700684 (sec)
[2023-02-18 14:50:39,035] [101256] [MainThread] [INFO] (monailabel.datastore.local:485) - Saving Label for Image: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423; Tag: final; Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}], 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.225842493.108979.1676706638.453906', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408'}
[2023-02-18 14:50:39,035] [101256] [MainThread] [INFO] (monailabel.datastore.local:493) - Adding Label: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => final => /tmp/tmp1r_aggvn.nii.gz
[2023-02-18 14:50:39,036] [101256] [MainThread] [INFO] (monailabel.datastore.local:509) - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}], 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.225842493.108979.1676706638.453906', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408', 'ts': 1676706639, 'name': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz'}
[2023-02-18 14:50:39,037] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:209) - Save completed!
[2023-02-18 14:50:39,037] [101256] [MainThread] [INFO] (monailabel.interfaces.app:492) - New label saved for: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:39,088] [101256] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 14:50:39,412] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-02-18 14:50:39,504] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[214,131,230,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"generic","description":"generic tissue seg"}]}
[2023-02-18 14:50:39,505] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:39,505] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmpfyont01g.bin
[2023-02-18 14:50:39,505] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-02-18 14:50:39,505] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}]}
[2023-02-18 14:50:39,505] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:39,505] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:50:41,907] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-02-18 14:50:41,908] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-02-18 14:50:41,908] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-02-18 14:50:42,063] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.557696580886841 (sec)
[2023-02-18 14:50:42,064] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmp0_pgkv2o.nii.gz
[2023-02-18 14:50:44,700] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 3 => generic
[2023-02-18 14:50:44,701] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 3,
        "SegmentLabel": "generic",
        "SegmentDescription": "generic tissue seg",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "generic"
        },
        "recommendedDisplayRGBValue": [
          214,
          131,
          230
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-02-18 14:50:44,701] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmp0_pgkv2o.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmpcipy4zmn.dcm --inputMetadata /tmp/tmppwsy2_a_.json
[2023-02-18 14:50:44,723] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-02-18 14:50:45,011] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-02-18 14:50:45,029] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-02-18 14:50:45,044] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-02-18 14:50:45,080] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-02-18 14:50:45,080] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 3
[2023-02-18 14:50:45,080] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 3 is 301
[2023-02-18 14:50:45,080] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-02-18 14:50:45,080] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to generic
[2023-02-18 14:50:45,278] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmpcipy4zmn.dcm
[2023-02-18 14:50:45,286] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-02-18 14:50:45,287] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.222136974334717 (sec)
[2023-02-18 14:50:45,386] [101256] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-02-18 14:50:45,454] [101256] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-02-18 14:50:45,555] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - ISO_IR 100
[2023-02-18 14:50:45,555] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - http://127.0.0.1/dicom-web/studies/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408
[2023-02-18 14:50:45,555] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-02-18 14:50:45,555] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - [(0008, 1150) Referenced SOP Class UID            UI: Segmentation Storage
(0008, 1155) Referenced SOP Instance UID         UI: 1.2.276.0.7230010.3.1.4.225842493.109017.1676706645.28327
(0008, 1190) Retrieve URL                        UR: 'http://127.0.0.1/dicom-web/studies/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408/series/1.2.276.0.7230010.3.1.3.225842493.109017.1676706645.28326/instances/1.2.276.0.7230010.3.1.4.225842493.109017.1676706645.28327']
[2023-02-18 14:50:45,556] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:128) - Series Instance UID: 1.2.276.0.7230010.3.1.3.225842493.109017.1676706645.28326
[2023-02-18 14:50:45,556] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:130) - Time to upload: 0.2683725357055664 (sec)
[2023-02-18 14:50:45,557] [101256] [MainThread] [INFO] (monailabel.datastore.local:485) - Saving Label for Image: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423; Tag: final; Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}], 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.225842493.109017.1676706645.28326', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408'}
[2023-02-18 14:50:45,557] [101256] [MainThread] [INFO] (monailabel.datastore.local:493) - Adding Label: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => final => /tmp/tmp0_pgkv2o.nii.gz
[2023-02-18 14:50:45,558] [101256] [MainThread] [INFO] (monailabel.datastore.local:509) - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}], 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.225842493.109017.1676706645.28326', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408', 'ts': 1676706645, 'name': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz'}
[2023-02-18 14:50:45,559] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:209) - Save completed!
[2023-02-18 14:50:45,559] [101256] [MainThread] [INFO] (monailabel.interfaces.app:492) - New label saved for: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:51:45,466] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:51:45,466] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:51:47,739] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-02-18 14:51:47,739] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-02-18 14:51:47,739] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-02-18 14:51:47,858] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.3913002014160156 (sec)
[2023-02-18 14:51:47,859] [101256] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'Histogram+GraphCut', 'image': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423', 'label': '/tmp/tmp1t92k8_a.nii.gz', 'num_bins': 64, 'lamda': 1, 'sigma': 0.1, 'device': ['cpu'], 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-02-18 14:51:47,859] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:51:47,859] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:51:47,859] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'num_bins': 64, 'lamda': 1, 'sigma': 0.1, 'device': 'cpu', 'model': 'Histogram+GraphCut', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz', 'label': '/tmp/tmp1t92k8_a.nii.gz', 'label_info': [{'id': 1, 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [226, 239, 131, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'main_scribbles', 'SegmentDescription': 'main segmentation volume for scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'main_scribbles', 'description': 'main segmentation volume for scribbles'}, {'id': 2, 'labelmapIndex': 1, 'segmentIndex': 2, 'color': [255, 0, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'background_scribbles', 'SegmentDescription': 'background scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'background_scribbles', 'description': 'background scribbles'}, {'id': 3, 'labelmapIndex': 1, 'segmentIndex': 3, 'color': [0, 255, 0, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'foreground_scribbles', 'SegmentDescription': 'foreground scribbles', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'foreground_scribbles', 'description': 'foreground scribbles'}], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A post processing step with histogram-based GraphCut for Generic segmentation'}
[2023-02-18 14:51:47,860] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-02-18 14:51:47,860] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-02-18 14:51:51,303] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 3.4428; image: torch.Size([512, 512, 301])(torch.float32); label: torch.Size([512, 512, 301])(torch.float32)
[2023-02-18 14:51:51,312] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0091; image: torch.Size([1, 512, 512, 301])(torch.float32); label: torch.Size([1, 512, 512, 301])(torch.float32)
[2023-02-18 14:51:51,312] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 14:51:51,313] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 14:51:51,445] [101256] [MainThread] [INFO] (monailabel.scribbles.transforms:121) - Scribbles: (1, 512, 512, 301)
[2023-02-18 14:51:51,494] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (AddBackgroundScribblesFromROId): Time: 0.1814; image: torch.Size([1, 512, 512, 301])(torch.float32); label: torch.Size([1, 512, 512, 301])(torch.float32)
[2023-02-18 14:51:51,772] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.2778; image: torch.Size([1, 167, 167, 61])(torch.float32); label: torch.Size([1, 167, 167, 61])(torch.float32)
[2023-02-18 14:51:51,783] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0111; image: torch.Size([1, 167, 167, 61])(torch.float32); label: torch.Size([1, 167, 167, 61])(torch.float32)
[2023-02-18 14:51:51,784] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => Compose => {'transforms': (<monailabel.scribbles.transforms.MakeLikelihoodFromScribblesHistogramd object at 0x7f3dc5dead90>,), 'map_items': True, 'unpack_items': False, 'log_stats': False, 'R': RandomState(MT19937) at 0x7F3E9F438C40}
[2023-02-18 14:51:51,784] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: None
[2023-02-18 14:51:51,784] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INF - Run Inferer(s)
[2023-02-18 14:51:51,784] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INF - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'label_meta_dict', 'latencies']
[2023-02-18 14:51:51,784] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 14:51:51,784] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 14:51:51,820] [101256] [MainThread] [INFO] (monailabel.scribbles.transforms:57) - found non normalized logits, normalizing using Softmax
[2023-02-18 14:51:51,829] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INF - Inferer (MakeLikelihoodFromScribblesHistogramd): Time: 0.0449; image: torch.Size([1, 167, 167, 61])(torch.float32); label: torch.Size([1, 167, 167, 61])(torch.float32)
[2023-02-18 14:51:51,830] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2023-02-18 14:51:51,830] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['num_bins', 'lamda', 'sigma', 'device', 'model', 'image', 'label', 'label_info', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'label_meta_dict', 'latencies', 'prob_meta_dict', 'prob']
[2023-02-18 14:51:51,830] [101256] [MainThread] [INFO] (root:83) - Loading background scribbles labels from: background_scribbles with index: 2
[2023-02-18 14:51:51,830] [101256] [MainThread] [INFO] (root:88) - Loading foreground scribbles labels from: foreground_scribbles with index: 3
[2023-02-18 14:51:51,839] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (MakeISegUnaryd): Time: 0.0089; image: torch.Size([1, 167, 167, 61])(torch.float32); label: torch.Size([1, 167, 167, 61])(torch.float32)
[2023-02-18 14:51:52,043] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (ApplyGraphCutOptimisationd): Time: 0.2039; image: torch.Size([1, 167, 167, 61])(torch.float32); label: torch.Size([1, 167, 167, 61])(torch.float32); pred: (1, 167, 167, 61)(float32)
[2023-02-18 14:51:52,144] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.1011; image: torch.Size([1, 167, 167, 61])(torch.float32); label: torch.Size([1, 167, 167, 61])(torch.float32); pred: torch.Size([512, 512, 301])(torch.float32)
[2023-02-18 14:51:52,173] [101256] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (BoundingBoxd): Time: 0.0289; image: torch.Size([1, 167, 167, 61])(torch.float32); label: torch.Size([1, 167, 167, 61])(torch.float32); pred: torch.Size([512, 512, 301])(torch.float32)
[2023-02-18 14:51:52,174] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:571) - Writing Result...
[2023-02-18 14:51:52,174] [101256] [MainThread] [INFO] (monailabel.transform.writer:189) - Result ext: .nrrd; write_to_file: True; dtype: uint16
[2023-02-18 14:51:52,660] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:334) - ++ Latencies => Total: 4.8009; Pre: 3.9239; Inferer: 0.0459; Invert: 0.0000; Post: 0.3442; Write: 0.4865
[2023-02-18 14:51:52,660] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:358) - Result File: /tmp/tmpilr50dmo.nrrd
[2023-02-18 14:51:52,660] [101256] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:359) - Result Json Keys: ['bbox', 'label_names', 'latencies']
[2023-02-18 14:54:30,213] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:54:30,364] [101256] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-02-18 14:54:30,436] [101256] [MainThread] [INFO] (dicomweb_client.web:2403) - retrieve metadata of series "1.2.276.0.7230010.3.1.3.225842493.109017.1676706645.28326" of study "1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408"
[2023-02-18 14:54:30,577] [101256] [MainThread] [INFO] (dicomweb_client.web:2403) - retrieve metadata of series "1.2.276.0.7230010.3.1.3.225842493.108979.1676706638.453906" of study "1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408"
[2023-02-18 14:54:33,493] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-02-18 14:54:33,585] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[214,131,230,255],"meta":{"_vrMap":{},"SegmentedPropertyCategoryCodeSequence":{"_vrMap":{},"CodeValue":"123037004","CodingSchemeDesignator":"SCT","CodeMeaning":"Anatomical Structure"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"AUTOMATIC","SegmentAlgorithmName":"MONAILABEL","RecommendedDisplayCIELabValue":[43715,45102,23314],"SegmentedPropertyTypeCodeSequence":{"_vrMap":{},"CodeValue":"78961009","CodingSchemeDesignator":"SCT","CodeMeaning":"generic"}},"name":"generic","description":"generic tissue seg"},{"id":"1+1","labelmapIndex":1,"segmentIndex":1,"color":[214,131,230,255],"meta":{"_vrMap":{},"SegmentedPropertyCategoryCodeSequence":{"_vrMap":{},"CodeValue":"123037004","CodingSchemeDesignator":"SCT","CodeMeaning":"Anatomical Structure"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"AUTOMATIC","SegmentAlgorithmName":"MONAILABEL","RecommendedDisplayCIELabValue":[43715,45102,23314],"SegmentedPropertyTypeCodeSequence":{"_vrMap":{},"CodeValue":"78961009","CodingSchemeDesignator":"SCT","CodeMeaning":"generic"}},"name":"generic","description":"generic tissue seg"}]}
[2023-02-18 14:54:33,586] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:54:33,586] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmp5l6l158_.bin
[2023-02-18 14:54:33,586] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-02-18 14:54:33,586] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}, {'id': '1+1', 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}]}
[2023-02-18 14:54:33,586] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:54:33,586] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:54:36,092] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-02-18 14:54:36,092] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-02-18 14:54:36,092] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-02-18 14:54:36,215] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.629091739654541 (sec)
[2023-02-18 14:54:36,217] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmpk7jmuf93.nii.gz
[2023-02-18 14:54:38,686] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => generic
[2023-02-18 14:54:38,686] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "generic",
        "SegmentDescription": "generic tissue seg",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "generic"
        },
        "recommendedDisplayRGBValue": [
          214,
          131,
          230
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-02-18 14:54:38,687] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmpk7jmuf93.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmpv64_3q2n.dcm --inputMetadata /tmp/tmpdan8tdig.json
[2023-02-18 14:54:38,704] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-02-18 14:54:38,957] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-02-18 14:54:38,973] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-02-18 14:54:38,987] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-02-18 14:54:39,022] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-02-18 14:54:39,022] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-02-18 14:54:39,022] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-02-18 14:54:39,022] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-02-18 14:54:39,022] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to generic
[2023-02-18 14:54:39,195] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmpv64_3q2n.dcm
[2023-02-18 14:54:39,202] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-02-18 14:54:39,202] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 2.9841573238372803 (sec)
[2023-02-18 14:54:39,296] [101256] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-02-18 14:54:39,362] [101256] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-02-18 14:54:39,436] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - ISO_IR 100
[2023-02-18 14:54:39,436] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - http://127.0.0.1/dicom-web/studies/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408
[2023-02-18 14:54:39,436] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-02-18 14:54:39,436] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - [(0008, 1150) Referenced SOP Class UID            UI: Segmentation Storage
(0008, 1155) Referenced SOP Instance UID         UI: 1.2.276.0.7230010.3.1.4.225842493.109331.1676706878.972706
(0008, 1190) Retrieve URL                        UR: 'http://127.0.0.1/dicom-web/studies/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408/series/1.2.276.0.7230010.3.1.3.225842493.109331.1676706878.972705/instances/1.2.276.0.7230010.3.1.4.225842493.109331.1676706878.972706']
[2023-02-18 14:54:39,436] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:128) - Series Instance UID: 1.2.276.0.7230010.3.1.3.225842493.109331.1676706878.972705
[2023-02-18 14:54:39,436] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:130) - Time to upload: 0.23371481895446777 (sec)
[2023-02-18 14:54:39,438] [101256] [MainThread] [INFO] (monailabel.datastore.local:485) - Saving Label for Image: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423; Tag: final; Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}, {'id': '1+1', 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}], 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.225842493.109331.1676706878.972705', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408'}
[2023-02-18 14:54:39,438] [101256] [MainThread] [INFO] (monailabel.datastore.local:493) - Adding Label: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => final => /tmp/tmpk7jmuf93.nii.gz
[2023-02-18 14:54:39,440] [101256] [MainThread] [INFO] (monailabel.datastore.local:509) - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}, {'id': '1+1', 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}], 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.225842493.109331.1676706878.972705', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408', 'ts': 1676706879, 'name': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz'}
[2023-02-18 14:54:39,440] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:209) - Save completed!
[2023-02-18 14:54:39,441] [101256] [MainThread] [INFO] (monailabel.interfaces.app:492) - New label saved for: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:54:39,968] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-02-18 14:54:40,054] [101256] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[214,131,230,255],"meta":{"_vrMap":{},"SegmentedPropertyCategoryCodeSequence":{"_vrMap":{},"CodeValue":"123037004","CodingSchemeDesignator":"SCT","CodeMeaning":"Anatomical Structure"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"AUTOMATIC","SegmentAlgorithmName":"MONAILABEL","RecommendedDisplayCIELabValue":[43715,45102,23314],"SegmentedPropertyTypeCodeSequence":{"_vrMap":{},"CodeValue":"78961009","CodingSchemeDesignator":"SCT","CodeMeaning":"generic"}},"name":"generic","description":"generic tissue seg"},{"id":"1+1","labelmapIndex":1,"segmentIndex":1,"color":[214,131,230,255],"meta":{"_vrMap":{},"SegmentedPropertyCategoryCodeSequence":{"_vrMap":{},"CodeValue":"123037004","CodingSchemeDesignator":"SCT","CodeMeaning":"Anatomical Structure"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"AUTOMATIC","SegmentAlgorithmName":"MONAILABEL","RecommendedDisplayCIELabValue":[43715,45102,23314],"SegmentedPropertyTypeCodeSequence":{"_vrMap":{},"CodeValue":"78961009","CodingSchemeDesignator":"SCT","CodeMeaning":"generic"}},"name":"generic","description":"generic tissue seg"}]}
[2023-02-18 14:54:40,055] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:54:40,055] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmp54dj8hhl.bin
[2023-02-18 14:54:40,055] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-02-18 14:54:40,055] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}, {'id': '1+1', 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}]}
[2023-02-18 14:54:40,055] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:54:40,055] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 14:54:42,368] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-02-18 14:54:42,368] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-02-18 14:54:42,368] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-02-18 14:54:42,482] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.42695689201355 (sec)
[2023-02-18 14:54:42,483] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmp0lp28_dc.nii.gz
[2023-02-18 14:54:45,001] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => generic
[2023-02-18 14:54:45,001] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "generic",
        "SegmentDescription": "generic tissue seg",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "generic"
        },
        "recommendedDisplayRGBValue": [
          214,
          131,
          230
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-02-18 14:54:45,010] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmp0lp28_dc.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmppoarl1un.dcm --inputMetadata /tmp/tmpemkqys_o.json
[2023-02-18 14:54:45,027] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-02-18 14:54:45,274] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-02-18 14:54:45,290] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-02-18 14:54:45,305] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-02-18 14:54:45,341] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-02-18 14:54:45,341] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-02-18 14:54:45,341] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-02-18 14:54:45,341] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-02-18 14:54:45,341] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to generic
[2023-02-18 14:54:45,514] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmppoarl1un.dcm
[2023-02-18 14:54:45,521] [101256] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-02-18 14:54:45,521] [101256] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.037712335586548 (sec)
[2023-02-18 14:54:45,615] [101256] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-02-18 14:54:45,679] [101256] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-02-18 14:54:45,753] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - ISO_IR 100
[2023-02-18 14:54:45,753] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - http://127.0.0.1/dicom-web/studies/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408
[2023-02-18 14:54:45,753] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-02-18 14:54:45,753] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - [(0008, 1150) Referenced SOP Class UID            UI: Segmentation Storage
(0008, 1155) Referenced SOP Instance UID         UI: 1.2.276.0.7230010.3.1.4.225842493.109368.1676706885.290251
(0008, 1190) Retrieve URL                        UR: 'http://127.0.0.1/dicom-web/studies/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408/series/1.2.276.0.7230010.3.1.3.225842493.109368.1676706885.290250/instances/1.2.276.0.7230010.3.1.4.225842493.109368.1676706885.290251']
[2023-02-18 14:54:45,753] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:128) - Series Instance UID: 1.2.276.0.7230010.3.1.3.225842493.109368.1676706885.290250
[2023-02-18 14:54:45,753] [101256] [MainThread] [INFO] (monailabel.datastore.utils.dicom:130) - Time to upload: 0.23162007331848145 (sec)
[2023-02-18 14:54:45,755] [101256] [MainThread] [INFO] (monailabel.datastore.local:485) - Saving Label for Image: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423; Tag: final; Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}, {'id': '1+1', 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}], 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.225842493.109368.1676706885.290250', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408'}
[2023-02-18 14:54:45,755] [101256] [MainThread] [INFO] (monailabel.datastore.local:493) - Adding Label: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => final => /tmp/tmp0lp28_dc.nii.gz
[2023-02-18 14:54:45,755] [101256] [MainThread] [INFO] (monailabel.datastore.local:509) - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}, {'id': '1+1', 'labelmapIndex': 1, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'_vrMap': {}, 'SegmentedPropertyCategoryCodeSequence': {'_vrMap': {}, 'CodeValue': '123037004', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'Anatomical Structure'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'AUTOMATIC', 'SegmentAlgorithmName': 'MONAILABEL', 'RecommendedDisplayCIELabValue': [43715, 45102, 23314], 'SegmentedPropertyTypeCodeSequence': {'_vrMap': {}, 'CodeValue': '78961009', 'CodingSchemeDesignator': 'SCT', 'CodeMeaning': 'generic'}}, 'name': 'generic', 'description': 'generic tissue seg'}], 'SeriesInstanceUID': '1.2.276.0.7230010.3.1.3.225842493.109368.1676706885.290250', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408', 'ts': 1676706885, 'name': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz'}
[2023-02-18 14:54:45,756] [101256] [MainThread] [INFO] (monailabel.datastore.dicom:209) - Save completed!
[2023-02-18 14:54:45,756] [101256] [MainThread] [INFO] (monailabel.interfaces.app:492) - New label saved for: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-02-18 15:00:25,700] [109628] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-02-18 15:00:25,802] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 15:00:25,804] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 15:00:25,804] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 15:00:25,805] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 15:00:25,805] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 15:00:25,806] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 15:00:25,806] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 15:00:25,806] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 15:00:25,806] [109628] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 15:00:25,806] [109628] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-02-18 15:00:25,850] [109628] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-02-18 15:00:25,850] [109628] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-02-18 15:00:25,850] [109628] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-02-18 15:00:25,850] [109628] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-02-18 15:00:25,850] [109628] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-02-18 15:00:25,851] [109628] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-02-18 15:00:25,851] [109628] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-02-18 15:00:25,851] [109628] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 15:00:25,851] [109628] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-02-18 15:00:25,852] [109628] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fd5b9f14850>
[2023-02-18 15:00:25,853] [109628] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fd5b9f14850>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fd5b9f147f0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fd5b9f358b0>}
[2023-02-18 15:00:25,853] [109628] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fd5b9f35910>
[2023-02-18 15:00:25,853] [109628] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-02-18 15:00:25,853] [109628] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-02-18 15:00:25,853] [109628] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-02-18 15:00:25,853] [109628] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-02-18 15:00:25,853] [109628] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fd5bac41940>
[2023-02-18 15:00:25,853] [109628] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-02-18 15:42:43,422] [110869] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-02-18 15:42:43,517] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 15:42:43,519] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 15:42:43,519] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 15:42:43,520] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 15:42:43,520] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 15:42:43,520] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 15:42:43,520] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 15:42:43,521] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 15:42:43,521] [110869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 15:42:43,521] [110869] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-02-18 15:42:43,543] [110869] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-02-18 15:42:43,543] [110869] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-02-18 15:42:43,543] [110869] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-02-18 15:42:43,543] [110869] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-02-18 15:42:43,544] [110869] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-02-18 15:42:43,544] [110869] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-02-18 15:42:43,544] [110869] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-02-18 15:42:43,545] [110869] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 15:42:43,545] [110869] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7ff0d7a4ac40>
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7ff0d7a4ac40>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7ff0d7a4abe0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7ff0d79fbca0>}
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7ff0d79fbd00>
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7ff0d8709940>
[2023-02-18 15:42:43,546] [110869] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-02-18 15:51:06,677] [111254] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-02-18 15:51:06,774] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-02-18 15:51:06,776] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-02-18 15:51:06,776] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-02-18 15:51:06,777] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-02-18 15:51:06,777] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-02-18 15:51:06,777] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-02-18 15:51:06,777] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-02-18 15:51:06,777] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-02-18 15:51:06,777] [111254] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-02-18 15:51:06,778] [111254] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-02-18 15:51:06,800] [111254] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-02-18 15:51:06,800] [111254] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-02-18 15:51:06,800] [111254] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-02-18 15:51:06,800] [111254] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-02-18 15:51:06,800] [111254] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-02-18 15:51:06,800] [111254] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-02-18 15:51:06,800] [111254] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-02-18 15:51:06,801] [111254] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-02-18 15:51:06,801] [111254] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-02-18 15:51:06,802] [111254] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f5066359670>
[2023-02-18 15:51:06,802] [111254] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f5066359670>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f5066359610>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f50663736d0>}
[2023-02-18 15:51:06,802] [111254] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f5066373730>
[2023-02-18 15:51:06,802] [111254] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-02-18 15:51:06,802] [111254] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-02-18 15:51:06,802] [111254] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-02-18 15:51:06,803] [111254] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-02-18 15:51:06,803] [111254] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f5067080940>
[2023-02-18 15:51:06,803] [111254] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-03-11 10:36:56,742] [15615] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-03-11 10:36:56,879] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-03-11 10:36:56,883] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-03-11 10:36:56,884] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-03-11 10:36:56,885] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-03-11 10:36:56,885] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-03-11 10:36:56,886] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-03-11 10:36:56,886] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-03-11 10:36:56,886] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-03-11 10:36:56,886] [15615] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-03-11 10:36:56,886] [15615] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-03-11 10:36:56,938] [15615] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-03-11 10:36:56,938] [15615] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-03-11 10:36:56,939] [15615] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-03-11 10:36:56,939] [15615] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-03-11 10:36:56,939] [15615] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-03-11 10:36:56,939] [15615] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-03-11 10:36:56,939] [15615] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-03-11 10:36:56,941] [15615] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-03-11 10:36:56,941] [15615] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7effcb936700>
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7effcb936700>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7effcb9366a0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7effcb94f760>}
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7effcb94f7c0>
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7effcc65c940>
[2023-03-11 10:36:56,943] [15615] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-03-11 10:37:55,372] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-03-11 10:37:55,474] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-03-11 10:37:55,476] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-03-11 10:37:55,477] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-03-11 10:37:55,477] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-03-11 10:37:55,478] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-03-11 10:37:55,478] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-03-11 10:37:55,478] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-03-11 10:37:55,478] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-03-11 10:37:55,478] [15906] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-03-11 10:37:55,478] [15906] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-03-11 10:37:55,519] [15906] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-03-11 10:37:55,520] [15906] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-03-11 10:37:55,520] [15906] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-03-11 10:37:55,520] [15906] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-03-11 10:37:55,521] [15906] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-03-11 10:37:55,521] [15906] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-03-11 10:37:55,521] [15906] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-03-11 10:37:55,522] [15906] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-03-11 10:37:55,522] [15906] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-03-11 10:37:55,523] [15906] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fea598097f0>
[2023-03-11 10:37:55,523] [15906] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fea598097f0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fea59809790>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fea59828850>}
[2023-03-11 10:37:55,523] [15906] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fea598288b0>
[2023-03-11 10:37:55,523] [15906] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-03-11 10:37:55,523] [15906] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-03-11 10:37:55,523] [15906] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-03-11 10:37:55,524] [15906] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-03-11 10:37:55,524] [15906] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fea5a534940>
[2023-03-11 10:37:55,524] [15906] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-03-11 10:39:56,922] [15906] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-03-11 10:39:56,952] [15906] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-03-11 10:55:09,732] [15906] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-03-11 10:55:09,757] [15906] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-03-11 10:56:37,981] [15906] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'segmentation_spleen', 'image': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423', 'device': ['cpu'], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-03-11 10:56:37,981] [15906] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-03-11 10:56:37,981] [15906] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-03-11 10:56:37,982] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'device': 'cpu', 'model': 'segmentation_spleen', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A pre-trained model for volumetric (3D) segmentation of the spleen from CT image'}
[2023-03-11 10:56:37,984] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-03-11 10:56:37,984] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-03-11 10:56:40,271] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 2.2867; image: torch.Size([512, 512, 301])(torch.float32)
[2023-03-11 10:56:40,272] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0005; image: torch.Size([512, 512, 301])(torch.float32)
[2023-03-11 10:56:40,274] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.002; image: torch.Size([1, 512, 512, 301])(torch.float32)
[2023-03-11 10:56:42,057] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.7833; image: torch.Size([1, 415, 415, 301])(torch.float32)
[2023-03-11 10:56:42,189] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.1311; image: torch.Size([1, 415, 415, 301])(torch.float32)
[2023-03-11 10:56:42,189] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => SlidingWindowInferer => {'roi_size': (160, 160, 160), 'sw_batch_size': 1, 'overlap': 0.25, 'mode': constant, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'roi_weight_map': None}
[2023-03-11 10:56:42,189] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology/model/pretrained_segmentation_spleen.pt
[2023-03-11 10:56:57,572] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2023-03-11 10:56:57,572] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'latencies', 'pred']
[2023-03-11 10:56:57,572] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 415, 415, 301])(torch.float32); pred: torch.Size([2, 415, 415, 301])(torch.float32)
[2023-03-11 10:56:57,618] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0459; image: torch.Size([1, 415, 415, 301])(torch.float32); pred: torch.Size([2, 415, 415, 301])(torch.float32)
[2023-03-11 10:57:01,222] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 3.6038; image: torch.Size([1, 415, 415, 301])(torch.float32); pred: torch.Size([1, 415, 415, 301])(torch.float32)
[2023-03-11 10:57:01,322] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0991; image: torch.Size([1, 415, 415, 301])(torch.float32); pred: torch.Size([512, 512, 301])(torch.float32)
[2023-03-11 10:57:01,332] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:571) - Writing Result...
[2023-03-11 10:57:01,333] [15906] [MainThread] [INFO] (monailabel.transform.writer:189) - Result ext: .nrrd; write_to_file: True; dtype: uint16
[2023-03-11 10:57:03,654] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:334) - ++ Latencies => Total: 25.6722; Pre: 4.2064; Inferer: 15.3823; Invert: 0.0000; Post: 3.7611; Write: 2.3219
[2023-03-11 10:57:03,655] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:358) - Result File: /tmp/tmpwhly5fl9.nrrd
[2023-03-11 10:57:03,655] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:359) - Result Json Keys: ['label_names', 'latencies']
[2023-03-11 14:33:41,470] [15906] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-03-11 14:33:41,486] [15906] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-03-11 14:34:01,144] [15906] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'segmentation_spleen', 'image': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423', 'device': ['cpu'], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-03-11 14:34:01,144] [15906] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-03-11 14:34:01,152] [15906] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-03-11 14:34:01,154] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'device': 'cpu', 'model': 'segmentation_spleen', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A pre-trained model for volumetric (3D) segmentation of the spleen from CT image'}
[2023-03-11 14:34:01,154] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-03-11 14:34:01,155] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-03-11 14:34:03,539] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 2.3822; image: torch.Size([512, 512, 301])(torch.float32)
[2023-03-11 14:34:03,539] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0004; image: torch.Size([512, 512, 301])(torch.float32)
[2023-03-11 14:34:03,540] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0007; image: torch.Size([1, 512, 512, 301])(torch.float32)
[2023-03-11 14:34:05,293] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.7527; image: torch.Size([1, 415, 415, 301])(torch.float32)
[2023-03-11 14:34:05,431] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.1377; image: torch.Size([1, 415, 415, 301])(torch.float32)
[2023-03-11 14:34:05,431] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => SlidingWindowInferer => {'roi_size': (160, 160, 160), 'sw_batch_size': 1, 'overlap': 0.25, 'mode': constant, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'roi_weight_map': None}
[2023-03-11 14:34:05,431] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: /home/ndvinh/Desktop/KLTN/MONAILabel/apps/radiology/model/pretrained_segmentation_spleen.pt
[2023-03-11 14:34:20,742] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2023-03-11 14:34:20,742] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'latencies', 'pred']
[2023-03-11 14:34:20,742] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 415, 415, 301])(torch.float32); pred: torch.Size([2, 415, 415, 301])(torch.float32)
[2023-03-11 14:34:20,796] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0539; image: torch.Size([1, 415, 415, 301])(torch.float32); pred: torch.Size([2, 415, 415, 301])(torch.float32)
[2023-03-11 14:34:24,292] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 3.4951; image: torch.Size([1, 415, 415, 301])(torch.float32); pred: torch.Size([1, 415, 415, 301])(torch.float32)
[2023-03-11 14:34:24,381] [15906] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0893; image: torch.Size([1, 415, 415, 301])(torch.float32); pred: torch.Size([512, 512, 301])(torch.float32)
[2023-03-11 14:34:24,391] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:571) - Writing Result...
[2023-03-11 14:34:24,391] [15906] [MainThread] [INFO] (monailabel.transform.writer:189) - Result ext: .nrrd; write_to_file: True; dtype: uint16
[2023-03-11 14:34:24,971] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:334) - ++ Latencies => Total: 23.8177; Pre: 4.2774; Inferer: 15.3104; Invert: 0.0000; Post: 3.6497; Write: 0.5799
[2023-03-11 14:34:24,971] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:358) - Result File: /tmp/tmpvji3_yn2.nrrd
[2023-03-11 14:34:24,971] [15906] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:359) - Result Json Keys: ['label_names', 'latencies']
[2023-05-13 10:00:48,194] [12780] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-13 10:00:48,335] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 10:00:48,338] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 10:00:48,339] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 10:00:48,340] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 10:00:48,341] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 10:00:48,342] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 10:00:48,342] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 10:00:48,342] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 10:00:48,342] [12780] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 10:00:48,343] [12780] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 10:00:48,404] [12780] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 10:00:48,404] [12780] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-13 10:00:48,404] [12780] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:00:48,404] [12780] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:00:48,405] [12780] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 10:00:48,405] [12780] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 10:00:48,405] [12780] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 10:00:48,407] [12780] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 10:00:48,407] [12780] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 10:00:48,409] [12780] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f745b0cb2e0>
[2023-05-13 10:00:48,409] [12780] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f745b0cb2e0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f745b0cb280>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f745b0dc310>}
[2023-05-13 10:00:48,409] [12780] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f745b0dc370>
[2023-05-13 10:00:48,409] [12780] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 10:00:48,409] [12780] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 10:00:48,409] [12780] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 10:00:48,410] [12780] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 10:00:48,410] [12780] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f745b0d63a0>
[2023-05-13 10:00:48,410] [12780] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 10:01:35,772] [13068] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-13 10:01:35,919] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 10:01:35,921] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 10:01:35,922] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 10:01:35,922] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 10:01:35,923] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 10:01:35,923] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 10:01:35,924] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 10:01:35,924] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 10:01:35,924] [13068] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 10:01:35,924] [13068] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 10:01:35,966] [13068] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 10:01:35,966] [13068] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-13 10:01:35,966] [13068] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:01:35,966] [13068] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:01:35,967] [13068] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 10:01:35,967] [13068] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 10:01:35,967] [13068] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 10:01:35,968] [13068] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 10:01:35,968] [13068] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 10:01:35,969] [13068] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f8bcdcdc1c0>
[2023-05-13 10:01:35,970] [13068] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f8bcdcdc1c0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f8bcdcdc160>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f8bcdced1f0>}
[2023-05-13 10:01:35,970] [13068] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f8bcdced250>
[2023-05-13 10:01:35,970] [13068] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 10:01:35,970] [13068] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 10:01:35,970] [13068] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 10:01:35,970] [13068] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 10:01:35,970] [13068] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f8bcdce63a0>
[2023-05-13 10:01:35,970] [13068] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 10:01:51,382] [13068] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndvinh/Desktop/KLTN/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-13 10:01:54,479] [13068] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndvinh/Desktop/KLTN/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-13 10:01:55,672] [13068] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndvinh/Desktop/KLTN/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-13 10:01:57,018] [13068] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndvinh/Desktop/KLTN/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-13 10:01:58,898] [13068] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndvinh/Desktop/KLTN/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-13 10:22:28,120] [21247] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-13 10:22:28,259] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 10:22:28,263] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 10:22:28,263] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 10:22:28,264] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 10:22:28,265] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 10:22:28,266] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 10:22:28,266] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 10:22:28,266] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 10:22:28,266] [21247] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 10:22:28,267] [21247] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 10:22:28,320] [21247] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 10:22:28,320] [21247] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-13 10:22:28,320] [21247] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:22:28,320] [21247] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:22:28,321] [21247] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 10:22:28,321] [21247] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 10:22:28,321] [21247] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 10:22:28,322] [21247] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 10:22:28,323] [21247] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 10:22:28,323] [21247] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fab192492e0>
[2023-05-13 10:22:28,323] [21247] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fab192492e0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fab19249280>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fab1925b310>}
[2023-05-13 10:22:28,323] [21247] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fab1925b370>
[2023-05-13 10:22:28,324] [21247] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 10:22:28,324] [21247] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 10:22:28,324] [21247] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 10:22:28,324] [21247] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 10:22:28,324] [21247] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fab192553a0>
[2023-05-13 10:22:28,324] [21247] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 10:35:37,712] [23494] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-13 10:35:37,828] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 10:35:37,830] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 10:35:37,830] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 10:35:37,831] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 10:35:37,832] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 10:35:37,832] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 10:35:37,832] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 10:35:37,832] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 10:35:37,832] [23494] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 10:35:37,833] [23494] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 10:35:37,875] [23494] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 10:35:37,875] [23494] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-13 10:35:37,875] [23494] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:35:37,875] [23494] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:35:37,876] [23494] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 10:35:37,876] [23494] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 10:35:37,876] [23494] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 10:35:37,877] [23494] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 10:35:37,877] [23494] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 10:35:37,878] [23494] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fa0eacff610>
[2023-05-13 10:35:37,878] [23494] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fa0eacff610>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fa0eacff5b0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fa0eac97640>}
[2023-05-13 10:35:37,878] [23494] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fa0eac976a0>
[2023-05-13 10:35:37,879] [23494] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 10:35:37,879] [23494] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 10:35:37,879] [23494] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 10:35:37,879] [23494] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 10:35:37,879] [23494] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fa0eac913a0>
[2023-05-13 10:35:37,879] [23494] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 10:35:39,560] [23494] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndvinh/Desktop/KLTN/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-13 10:39:39,303] [28299] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-13 10:39:39,436] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 10:39:39,439] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 10:39:39,439] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 10:39:39,439] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 10:39:39,440] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 10:39:39,440] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 10:39:39,441] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 10:39:39,441] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 10:39:39,441] [28299] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 10:39:39,441] [28299] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 10:39:39,497] [28299] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 10:39:39,497] [28299] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-13 10:39:39,497] [28299] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:39:39,497] [28299] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:39:39,498] [28299] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 10:39:39,498] [28299] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 10:39:39,498] [28299] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 10:39:39,499] [28299] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 10:39:39,499] [28299] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 10:39:39,500] [28299] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fb7e5153490>
[2023-05-13 10:39:39,501] [28299] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fb7e5153490>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fb7e5153430>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fb7e50e74c0>}
[2023-05-13 10:39:39,501] [28299] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fb7e50e7520>
[2023-05-13 10:39:39,501] [28299] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 10:39:39,501] [28299] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 10:39:39,501] [28299] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 10:39:39,501] [28299] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 10:39:39,501] [28299] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fb7e50e13a0>
[2023-05-13 10:39:39,501] [28299] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 10:45:09,167] [29134] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-13 10:45:09,280] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 10:45:09,283] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 10:45:09,283] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 10:45:09,284] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 10:45:09,284] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 10:45:09,285] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 10:45:09,285] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 10:45:09,285] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 10:45:09,285] [29134] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 10:45:09,285] [29134] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 10:45:09,326] [29134] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 10:45:09,326] [29134] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-13 10:45:09,326] [29134] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:45:09,326] [29134] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:45:09,327] [29134] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 10:45:09,327] [29134] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 10:45:09,327] [29134] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 10:45:09,328] [29134] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 10:45:09,329] [29134] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 10:45:09,330] [29134] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7ff93db9d460>
[2023-05-13 10:45:09,330] [29134] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7ff93db9d460>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7ff93db9d400>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7ff93db31490>}
[2023-05-13 10:45:09,330] [29134] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7ff93db314f0>
[2023-05-13 10:45:09,330] [29134] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 10:45:09,330] [29134] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 10:45:09,330] [29134] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 10:45:09,330] [29134] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 10:45:09,331] [29134] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7ff93db2b3a0>
[2023-05-13 10:45:09,331] [29134] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 10:45:18,595] [29134] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndvinh/Desktop/KLTN/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-13 10:51:43,605] [33952] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-13 10:51:43,727] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 10:51:43,731] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 10:51:43,731] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 10:51:43,732] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 10:51:43,733] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 10:51:43,733] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 10:51:43,734] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 10:51:43,734] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 10:51:43,734] [33952] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 10:51:43,734] [33952] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 10:51:43,785] [33952] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 10:51:43,786] [33952] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-13 10:51:43,786] [33952] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:51:43,786] [33952] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:51:43,787] [33952] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 10:51:43,787] [33952] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 10:51:43,787] [33952] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 10:51:43,789] [33952] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 10:51:43,789] [33952] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 10:51:43,790] [33952] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f6cee3bf7f0>
[2023-05-13 10:51:43,790] [33952] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f6cee3bf7f0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f6cee3bf790>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f6cee362820>}
[2023-05-13 10:51:43,790] [33952] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f6cee362880>
[2023-05-13 10:51:43,791] [33952] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 10:51:43,791] [33952] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 10:51:43,791] [33952] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 10:51:43,791] [33952] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 10:51:43,791] [33952] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f6cee35c3a0>
[2023-05-13 10:51:43,791] [33952] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 10:54:36,128] [35146] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-13 10:54:36,224] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 10:54:36,226] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 10:54:36,227] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 10:54:36,227] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 10:54:36,228] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 10:54:36,228] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 10:54:36,228] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 10:54:36,229] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 10:54:36,229] [35146] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 10:54:36,229] [35146] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 10:54:36,254] [35146] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 10:54:36,254] [35146] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-13 10:54:36,254] [35146] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:54:36,254] [35146] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 10:54:36,254] [35146] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 10:54:36,254] [35146] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 10:54:36,255] [35146] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 10:54:36,255] [35146] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 10:54:36,255] [35146] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fcb4fd0b670>
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fcb4fd0b670>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fcb4fd0b610>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fcb4fca66a0>}
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fcb4fca6700>
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fcb4fc9f3a0>
[2023-05-13 10:54:36,257] [35146] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 14:04:14,019] [63766] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 14:04:14,155] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 14:04:14,159] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 14:04:14,159] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 14:04:14,160] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 14:04:14,161] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 14:04:14,162] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 14:04:14,162] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 14:04:14,162] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 14:04:14,163] [63766] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 14:04:14,163] [63766] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 14:04:14,226] [63766] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 14:04:14,226] [63766] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 14:04:14,260] [63766] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 14:04:14,335] [63766] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 14:04:14,409] [63766] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 14:04:14,482] [63766] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 14:04:14,483] [63766] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 14:04:14,483] [63766] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 14:04:14,492] [63766] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 14:04:14,492] [63766] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 14:04:14,492] [63766] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 14:04:14,494] [63766] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 14:04:14,495] [63766] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 14:04:14,496] [63766] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f50eca27190>
[2023-05-13 14:04:14,496] [63766] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f50eca27130>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f50eca391c0>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f50eca39190>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f50eca39100>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f50eca27190>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f50eca27130>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f50eca391c0>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f50eca39190>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f50eca39100>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f50eca391f0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f50eca39220>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f50eca39250>}
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f50eca39310>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f50eca39340>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f50eca39370>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f50eca393a0>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f50eca393d0>
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 14:04:14,497] [63766] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 14:04:14,498] [63766] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f50eca368b0>
[2023-05-13 14:04:14,498] [63766] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 14:08:39,356] [66932] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 14:08:39,494] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 14:08:39,498] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 14:08:39,498] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 14:08:39,499] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 14:08:39,500] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 14:08:39,501] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 14:08:39,501] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 14:08:39,501] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 14:08:39,501] [66932] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 14:08:39,502] [66932] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 14:08:39,557] [66932] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 14:08:39,557] [66932] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 14:08:39,591] [66932] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 14:08:39,666] [66932] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 14:08:39,740] [66932] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 14:08:39,812] [66932] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 14:08:39,813] [66932] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 14:08:39,813] [66932] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 14:08:39,813] [66932] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 14:08:39,813] [66932] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 14:08:39,814] [66932] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 14:08:39,823] [66932] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 14:08:39,823] [66932] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7faeb6cf1370>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7faeb6cf1310>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7faeb6d043a0>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7faeb6d04370>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7faeb6d042e0>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7faeb6cf1370>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7faeb6cf1310>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7faeb6d043a0>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7faeb6d04370>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7faeb6d042e0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7faeb6d043d0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7faeb6d04400>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7faeb6d04430>}
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7faeb6d044f0>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7faeb6d04520>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7faeb6d04550>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7faeb6d04580>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7faeb6d045b0>
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 14:08:39,824] [66932] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 14:08:39,825] [66932] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 14:08:39,825] [66932] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7faeb6d018b0>
[2023-05-13 14:08:39,825] [66932] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 14:20:46,580] [75325] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 14:20:46,720] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 14:20:46,723] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 14:20:46,724] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 14:20:46,725] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 14:20:46,726] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 14:20:46,726] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 14:20:46,726] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 14:20:46,727] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 14:20:46,727] [75325] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 14:20:46,727] [75325] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 14:20:46,788] [75325] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 14:20:46,788] [75325] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 14:20:46,822] [75325] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 14:20:46,897] [75325] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 14:20:46,968] [75325] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 14:20:47,047] [75325] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 14:20:47,047] [75325] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 14:20:47,047] [75325] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 14:20:47,048] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 14:20:47,048] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 14:20:47,048] [75325] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 14:20:47,049] [75325] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 14:20:47,049] [75325] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f0c2f03f460>
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f0c2f03f400>
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f0c2f052490>
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f0c2f052460>
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f0c2f0523d0>
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f0c2f03f460>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f0c2f03f400>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f0c2f052490>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f0c2f052460>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f0c2f0523d0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f0c2f0524c0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f0c2f0524f0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f0c2f052520>}
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f0c2f0525e0>
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f0c2f052610>
[2023-05-13 14:20:47,050] [75325] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f0c2f052640>
[2023-05-13 14:20:47,051] [75325] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f0c2f052670>
[2023-05-13 14:20:47,051] [75325] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f0c2f0526a0>
[2023-05-13 14:20:47,051] [75325] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 14:20:47,051] [75325] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 14:20:47,051] [75325] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 14:20:47,051] [75325] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 14:20:47,051] [75325] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f0c2f04f8b0>
[2023-05-13 14:20:47,051] [75325] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 14:40:18,417] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 14:40:18,473] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 14:40:33,221] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 14:40:33,303] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[214,131,230,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"generic","description":"generic tissue seg"}]}
[2023-05-13 14:40:33,303] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 14:40:33,303] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmpbj_sumo7.bin
[2023-05-13 14:40:33,303] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 14:40:33,303] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}]}
[2023-05-13 14:40:33,303] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 14:40:33,303] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 14:40:35,580] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 14:40:35,580] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 14:40:35,580] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 14:40:37,491] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 4.187133073806763 (sec)
[2023-05-13 14:40:37,492] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmpgtna9xj5.nii.gz
[2023-05-13 14:40:40,138] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    []
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 14:40:40,138] [75325] [MainThread] [ERROR] (monailabel.datastore.utils.convert:143) - Missing Attributes/Empty Label provided
[2023-05-13 14:40:40,627] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 14:40:40,706] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[214,131,230,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"generic","SegmentDescription":"generic tissue seg","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"generic","description":"generic tissue seg"}]}
[2023-05-13 14:40:40,706] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 14:40:40,706] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmp2jai535f.bin
[2023-05-13 14:40:40,706] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 14:40:40,706] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [214, 131, 230, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'generic', 'SegmentDescription': 'generic tissue seg', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'generic', 'description': 'generic tissue seg'}]}
[2023-05-13 14:40:40,706] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 14:40:40,706] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 14:40:42,962] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 14:40:42,962] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 14:40:42,962] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 14:40:43,079] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.372368335723877 (sec)
[2023-05-13 14:40:43,081] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmphb054icd.nii.gz
[2023-05-13 14:40:45,885] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    []
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 14:40:45,886] [75325] [MainThread] [ERROR] (monailabel.datastore.utils.convert:143) - Missing Attributes/Empty Label provided
[2023-05-13 14:52:05,864] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 14:52:05,886] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 14:58:49,433] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 14:58:49,450] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:11:16,222] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:11:16,238] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:12:16,433] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 15:12:16,516] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[74,68,207,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"jose","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"jose","description":""}]}
[2023-05-13 15:12:16,516] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:12:16,516] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmp4uf29v7e.bin
[2023-05-13 15:12:16,516] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 15:12:16,516] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [74, 68, 207, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'jose', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'jose', 'description': ''}]}
[2023-05-13 15:12:16,516] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:12:16,524] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:12:18,871] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 15:12:18,871] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 15:12:18,871] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 15:12:19,017] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.492130994796753 (sec)
[2023-05-13 15:12:19,021] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmpv0jj3p22.nii.gz
[2023-05-13 15:12:21,841] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => jose
[2023-05-13 15:12:21,841] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "jose",
        "SegmentDescription": "",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "jose"
        },
        "recommendedDisplayRGBValue": [
          74,
          68,
          207
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 15:12:21,846] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmpv0jj3p22.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmpn41x5ce_.dcm --inputMetadata /tmp/tmpv2_n3moa.json
[2023-05-13 15:12:21,929] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-05-13 15:12:22,193] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-05-13 15:12:22,320] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-05-13 15:12:22,336] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-05-13 15:12:22,405] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-05-13 15:12:22,405] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-05-13 15:12:22,405] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-05-13 15:12:22,405] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-05-13 15:12:22,405] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to jose
[2023-05-13 15:12:22,579] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmpn41x5ce_.dcm
[2023-05-13 15:12:22,586] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-05-13 15:12:22,586] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.5654728412628174 (sec)
[2023-05-13 15:12:22,695] [75325] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-05-13 15:12:22,770] [75325] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-05-13 15:12:52,820] [75325] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - ISO_IR 100
[2023-05-13 15:12:52,821] [75325] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-05-13 15:12:52,821] [75325] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-05-13 15:12:52,821] [75325] [MainThread] [INFO] (monailabel.datastore.utils.dicom:128) - Series Instance UID: 
[2023-05-13 15:12:52,821] [75325] [MainThread] [INFO] (monailabel.datastore.utils.dicom:130) - Time to upload: 30.233797550201416 (sec)
[2023-05-13 15:12:52,824] [75325] [MainThread] [INFO] (monailabel.datastore.local:485) - Saving Label for Image: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423; Tag: final; Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [74, 68, 207, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'jose', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'jose', 'description': ''}], 'SeriesInstanceUID': '', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408'}
[2023-05-13 15:12:52,824] [75325] [MainThread] [INFO] (monailabel.datastore.local:493) - Adding Label: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => final => /tmp/tmpv0jj3p22.nii.gz
[2023-05-13 15:12:52,829] [75325] [MainThread] [INFO] (monailabel.datastore.local:509) - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [74, 68, 207, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'jose', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'jose', 'description': ''}], 'SeriesInstanceUID': '', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408', 'ts': 1683965572, 'name': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz'}
[2023-05-13 15:12:52,831] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:209) - Save completed!
[2023-05-13 15:12:52,832] [75325] [MainThread] [INFO] (monailabel.interfaces.app:492) - New label saved for: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:12:52,881] [75325] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 15:14:02,932] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 15:14:03,013] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[93,151,130,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"rose","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"rose","description":""}]}
[2023-05-13 15:14:03,013] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:14:03,013] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmp8n8bn3ox.bin
[2023-05-13 15:14:03,013] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 15:14:03,013] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [93, 151, 130, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'rose', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'rose', 'description': ''}]}
[2023-05-13 15:14:03,013] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:14:03,013] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:14:05,259] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 15:14:05,259] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 15:14:05,259] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 15:14:05,378] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.3640153408050537 (sec)
[2023-05-13 15:14:05,379] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmpstu_9o0s.nii.gz
[2023-05-13 15:14:08,321] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => rose
[2023-05-13 15:14:08,321] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "rose",
        "SegmentDescription": "",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "rose"
        },
        "recommendedDisplayRGBValue": [
          93,
          151,
          130
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 15:14:08,322] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmpstu_9o0s.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmp3hzyt7gj.dcm --inputMetadata /tmp/tmpfb1gp5ny.json
[2023-05-13 15:14:08,340] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-05-13 15:14:08,615] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-05-13 15:14:08,632] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-05-13 15:14:08,644] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-05-13 15:14:08,684] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-05-13 15:14:08,685] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-05-13 15:14:08,685] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-05-13 15:14:08,685] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-05-13 15:14:08,685] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to rose
[2023-05-13 15:14:08,872] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmp3hzyt7gj.dcm
[2023-05-13 15:14:08,883] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-05-13 15:14:08,883] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.504415512084961 (sec)
[2023-05-13 15:14:09,001] [75325] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-05-13 15:14:09,081] [75325] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-05-13 15:14:59,792] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 15:14:59,872] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[93,151,130,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"rose","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"rose","description":""}]}
[2023-05-13 15:14:59,873] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:14:59,873] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmpqw_g4g17.bin
[2023-05-13 15:14:59,873] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 15:14:59,873] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [93, 151, 130, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'rose', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'rose', 'description': ''}]}
[2023-05-13 15:14:59,873] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:14:59,873] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:15:02,590] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 15:15:02,591] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 15:15:02,591] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 15:15:02,703] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.8298583030700684 (sec)
[2023-05-13 15:15:02,704] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmps_kfqko0.nii.gz
[2023-05-13 15:15:05,424] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => rose
[2023-05-13 15:15:05,424] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "rose",
        "SegmentDescription": "",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "rose"
        },
        "recommendedDisplayRGBValue": [
          93,
          151,
          130
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 15:15:05,425] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmps_kfqko0.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmpa7g8qrnd.dcm --inputMetadata /tmp/tmp_zi_qadv.json
[2023-05-13 15:15:05,444] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-05-13 15:15:05,719] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-05-13 15:15:05,736] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-05-13 15:15:05,748] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-05-13 15:15:05,784] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-05-13 15:15:05,784] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-05-13 15:15:05,784] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-05-13 15:15:05,784] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-05-13 15:15:05,784] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to rose
[2023-05-13 15:15:05,985] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmpa7g8qrnd.dcm
[2023-05-13 15:15:05,994] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-05-13 15:15:05,994] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.2901294231414795 (sec)
[2023-05-13 15:15:06,101] [75325] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-05-13 15:15:06,179] [75325] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-05-13 15:17:23,472] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:17:23,502] [75325] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:17:48,491] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 15:17:48,568] [75325] [MainThread] [INFO] (monailabel.endpoints.datastore:111) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[237,227,246,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"nathan","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"nathan","description":""}]}
[2023-05-13 15:17:48,569] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:17:48,569] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmpo57buizt.bin
[2023-05-13 15:17:48,569] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 15:17:48,569] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [237, 227, 246, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'nathan', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'nathan', 'description': ''}]}
[2023-05-13 15:17:48,569] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:17:48,569] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:17:50,796] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 15:17:50,796] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 15:17:50,796] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 15:17:50,908] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.338803768157959 (sec)
[2023-05-13 15:17:50,909] [75325] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmpr29l3gw7.nii.gz
[2023-05-13 15:17:53,583] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => nathan
[2023-05-13 15:17:53,583] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "nathan",
        "SegmentDescription": "",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "nathan"
        },
        "recommendedDisplayRGBValue": [
          237,
          227,
          246
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 15:17:53,583] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmpr29l3gw7.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmpf4wm2xk8.dcm --inputMetadata /tmp/tmp_assafyg.json
[2023-05-13 15:17:53,603] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-05-13 15:17:53,860] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-05-13 15:17:53,877] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-05-13 15:17:53,890] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-05-13 15:17:53,925] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-05-13 15:17:53,925] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-05-13 15:17:53,925] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-05-13 15:17:53,925] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-05-13 15:17:53,925] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to nathan
[2023-05-13 15:17:54,101] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmpf4wm2xk8.dcm
[2023-05-13 15:17:54,108] [75325] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-05-13 15:17:54,108] [75325] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.1988906860351562 (sec)
[2023-05-13 15:17:54,217] [75325] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-05-13 15:17:54,447] [75325] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-05-13 15:28:05,691] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 15:28:05,812] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 15:28:05,815] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 15:28:05,815] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 15:28:05,816] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 15:28:05,816] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 15:28:05,817] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 15:28:05,817] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 15:28:05,817] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 15:28:05,817] [89037] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 15:28:05,817] [89037] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 15:28:05,868] [89037] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 15:28:05,869] [89037] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 15:28:05,901] [89037] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 15:28:05,974] [89037] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 15:28:06,046] [89037] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 15:28:06,115] [89037] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 15:28:06,115] [89037] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:28:06,116] [89037] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:28:06,116] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 15:28:06,116] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 15:28:06,116] [89037] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 15:28:06,117] [89037] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 15:28:06,117] [89037] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 15:28:06,126] [89037] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f6173b61370>
[2023-05-13 15:28:06,126] [89037] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f6173b61310>
[2023-05-13 15:28:06,126] [89037] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f6173af53d0>
[2023-05-13 15:28:06,126] [89037] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f6173af53a0>
[2023-05-13 15:28:06,126] [89037] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f6173af5310>
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f6173b61370>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f6173b61310>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f6173af53d0>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f6173af53a0>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f6173af5310>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f6173af5400>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f6173af5430>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f6173af5460>}
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f6173af5520>
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f6173af5550>
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f6173af5580>
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f6173af55b0>
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f6173af55e0>
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f6173b728b0>
[2023-05-13 15:28:06,127] [89037] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-13 15:28:17,203] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:28:17,220] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:28:32,155] [89037] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 15:28:32,250] [89037] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[217,36,156,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"judy","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"judy","description":""}]}
[2023-05-13 15:28:32,250] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:28:32,250] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmp0ikz4vh_.bin
[2023-05-13 15:28:32,250] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 15:28:32,250] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [217, 36, 156, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'judy', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'judy', 'description': ''}]}
[2023-05-13 15:28:32,250] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:28:32,251] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:28:34,769] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 15:28:34,769] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 15:28:34,769] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 15:28:36,637] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 4.385883092880249 (sec)
[2023-05-13 15:28:36,638] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmpuqe82wjy.nii.gz
[2023-05-13 15:28:39,391] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => judy
[2023-05-13 15:28:39,391] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "judy",
        "SegmentDescription": "",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "judy"
        },
        "recommendedDisplayRGBValue": [
          217,
          36,
          156
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 15:28:39,392] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmpuqe82wjy.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmptutlo6zd.dcm --inputMetadata /tmp/tmps5tal14h.json
[2023-05-13 15:28:39,409] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-05-13 15:28:39,676] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-05-13 15:28:39,694] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-05-13 15:28:39,708] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-05-13 15:28:39,745] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-05-13 15:28:39,745] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-05-13 15:28:39,745] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-05-13 15:28:39,745] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-05-13 15:28:39,745] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to judy
[2023-05-13 15:28:39,922] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmptutlo6zd.dcm
[2023-05-13 15:28:39,930] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-05-13 15:28:39,930] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.291609525680542 (sec)
[2023-05-13 15:28:40,030] [89037] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-05-13 15:28:40,107] [89037] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-05-13 15:29:10,160] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - ISO_IR 100
[2023-05-13 15:29:10,161] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-05-13 15:29:10,161] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-05-13 15:29:10,161] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:128) - Series Instance UID: 
[2023-05-13 15:29:10,161] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:130) - Time to upload: 30.23037552833557 (sec)
[2023-05-13 15:29:10,170] [89037] [MainThread] [INFO] (monailabel.datastore.local:485) - Saving Label for Image: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423; Tag: final; Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [217, 36, 156, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'judy', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'judy', 'description': ''}], 'SeriesInstanceUID': '', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408'}
[2023-05-13 15:29:10,171] [89037] [MainThread] [INFO] (monailabel.datastore.local:493) - Adding Label: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => final => /tmp/tmpuqe82wjy.nii.gz
[2023-05-13 15:29:10,173] [89037] [MainThread] [INFO] (monailabel.datastore.local:509) - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [217, 36, 156, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'judy', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'judy', 'description': ''}], 'SeriesInstanceUID': '', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408', 'ts': 1683966550, 'name': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz'}
[2023-05-13 15:29:10,178] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:209) - Save completed!
[2023-05-13 15:29:10,179] [89037] [MainThread] [INFO] (monailabel.interfaces.app:492) - New label saved for: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:30:29,510] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 15:30:29,512] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:29,512] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'deepgrow_2d', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 15:30:29,513] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:29,514] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'localization_spine', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 15:30:29,515] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_spleen","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 15:30:29,515] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'localization_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 15:30:29,533] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 15:30:29,709] [89547] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 15:30:31,471] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 15:30:31,473] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 15:30:31,473] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 15:30:31,474] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 15:30:31,475] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 15:30:31,475] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 15:30:31,475] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 15:30:31,475] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 15:30:31,475] [89547] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 15:30:31,475] [89547] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 15:30:31,518] [89547] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 15:30:31,518] [89547] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 15:30:31,552] [89547] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 15:30:31,632] [89547] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 15:30:31,715] [89547] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 15:30:31,796] [89547] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 15:30:31,796] [89547] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:31,796] [89547] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:31,797] [89547] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 15:30:31,797] [89547] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 15:30:31,797] [89547] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 15:30:31,799] [89547] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 15:30:31,799] [89547] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 15:30:31,800] [89547] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fd5cf751a00>
[2023-05-13 15:30:31,800] [89547] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7fd5cf7519a0>
[2023-05-13 15:30:31,800] [89547] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7fd5cbd93a60>
[2023-05-13 15:30:31,800] [89547] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fd5cbd93a30>
[2023-05-13 15:30:31,800] [89547] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fd5cbd939a0>
[2023-05-13 15:30:31,800] [89547] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fd5cf751a00>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7fd5cf7519a0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7fd5cbd93a60>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fd5cbd93a30>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fd5cbd939a0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fd5cbd93a90>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fd5cbd93ac0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7fd5cbd93af0>}
[2023-05-13 15:30:31,800] [89547] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fd5cbd93bb0>
[2023-05-13 15:30:31,800] [89547] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7fd5cbd93be0>
[2023-05-13 15:30:31,801] [89547] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7fd5cbd93c10>
[2023-05-13 15:30:31,801] [89547] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7fd5cbd93c40>
[2023-05-13 15:30:31,801] [89547] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7fd5cbd93c70>
[2023-05-13 15:30:31,801] [89547] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 15:30:31,801] [89547] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 15:30:31,801] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 15:30:31,801] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 15:30:31,801] [89547] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:30:31,804] [89547] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: {'1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423'}
[2023-05-13 15:30:31,804] [89547] [MainThread] [INFO] (monailabel.datastore.dicom:241) - Label 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 not exist on remote;  Remove from local
[2023-05-13 15:30:31,804] [89037] [Thread-1] [INFO] (monailabel.datastore.local:652) - Removing non existing Label Id: '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423' for 'final'
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_spleen', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_153031'}
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_spleen/train_01
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_spleen/train_01/mlruns;
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_spleen; Run Name: run_20230513_153031
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 1
[2023-05-13 15:30:31,805] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 15:30:31,814] [89547] [Thread-1] [INFO] (monailabel.datastore.local:652) - Removing non existing Label Id: '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423' for 'final'
[2023-05-13 15:30:31,818] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_segmentation_spleen.pt
[2023-05-13 15:30:31,819] [89547] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 1
[2023-05-13 15:30:31,820] [89547] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 1
torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
[2023-05-13 15:30:31,825] [89547] [MainThread] [INFO] (ignite.engine.engine.SupervisedTrainer:876) - Engine run resuming from iteration 0, epoch 0 until 50 epochs
[2023-05-13 15:30:31,833] [89547] [MainThread] [ERROR] (ignite.engine.engine.SupervisedTrainer:992) - Engine run is terminating due to exception: Attempting to deserialize object on a CUDA device but torch.cuda.is_available() is False. If you are running on a CPU-only machine, please use torch.load with map_location=torch.device('cpu') to map your storages to the CPU.
[2023-05-13 15:30:31,833] [89547] [MainThread] [ERROR] (ignite.engine.engine.SupervisedTrainer:180) - Exception: Attempting to deserialize object on a CUDA device but torch.cuda.is_available() is False. If you are running on a CPU-only machine, please use torch.load with map_location=torch.device('cpu') to map your storages to the CPU.
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 946, in _internal_run_as_gen
    self._fire_event(Events.STARTED)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/handlers/checkpoint_loader.py", line 107, in __call__
    checkpoint = torch.load(self.load_path, map_location=self.map_location)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 789, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 1131, in _load
    result = unpickler.load()
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 1101, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 1083, in load_tensor
    wrap_storage=restore_location(storage, location),
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 215, in default_restore_location
    result = fn(storage, location)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 182, in _cuda_deserialize
    device = validate_cuda_device(location)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 166, in validate_cuda_device
    raise RuntimeError('Attempting to deserialize object on a CUDA '
RuntimeError: Attempting to deserialize object on a CUDA device but torch.cuda.is_available() is False. If you are running on a CPU-only machine, please use torch.load with map_location=torch.device('cpu') to map your storages to the CPU.
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 552, in train
    context.trainer.run()
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/engines/trainer.py", line 53, in run
    super().run()
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/engines/workflow.py", line 281, in run
    super().run(data=self.data_loader, max_epochs=self.state.max_epochs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 892, in run
    return self._internal_run()
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 935, in _internal_run
    return next(self._internal_run_generator)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 993, in _internal_run_as_gen
    self._handle_exception(e)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 636, in _handle_exception
    self._fire_event(Events.EXCEPTION_RAISED, e)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/handlers/stats_handler.py", line 181, in exception_raised
    raise e
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 946, in _internal_run_as_gen
    self._fire_event(Events.STARTED)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/handlers/checkpoint_loader.py", line 107, in __call__
    checkpoint = torch.load(self.load_path, map_location=self.map_location)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 789, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 1131, in _load
    result = unpickler.load()
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 1101, in persistent_load
    load_tensor(dtype, nbytes, key, _maybe_decode_ascii(location))
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 1083, in load_tensor
    wrap_storage=restore_location(storage, location),
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 215, in default_restore_location
    result = fn(storage, location)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 182, in _cuda_deserialize
    device = validate_cuda_device(location)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/serialization.py", line 166, in validate_cuda_device
    raise RuntimeError('Attempting to deserialize object on a CUDA '
RuntimeError: Attempting to deserialize object on a CUDA device but torch.cuda.is_available() is False. If you are running on a CPU-only machine, please use torch.load with map_location=torch.device('cpu') to map your storages to the CPU.
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 15:30:31,858] [89037] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 1
[2023-05-13 15:30:32,241] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 15:30:32,241] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:32,241] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:32,241] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"deepgrow_2d","name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 15:30:32,392] [89635] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 15:30:33,968] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 15:30:33,971] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 15:30:33,971] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 15:30:33,971] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 15:30:33,972] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 15:30:33,972] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 15:30:33,972] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 15:30:33,972] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 15:30:33,972] [89635] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 15:30:33,972] [89635] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 15:30:34,015] [89635] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 15:30:34,015] [89635] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 15:30:34,049] [89635] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 15:30:34,126] [89635] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 15:30:34,202] [89635] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 15:30:34,274] [89635] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 15:30:34,275] [89635] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:34,275] [89635] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:34,275] [89635] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 15:30:34,276] [89635] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 15:30:34,276] [89635] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 15:30:34,277] [89635] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 15:30:34,277] [89635] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7ff00b92c790>
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7ff00b92c730>
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7ff007f637c0>
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7ff007f63790>
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7ff007f63700>
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7ff00b92c790>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7ff00b92c730>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7ff007f637c0>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7ff007f63790>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7ff007f63700>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7ff007f637f0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7ff007f63820>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7ff007f63850>}
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7ff007f63910>
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7ff007f63940>
[2023-05-13 15:30:34,278] [89635] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7ff007f63970>
[2023-05-13 15:30:34,279] [89635] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7ff007f639a0>
[2023-05-13 15:30:34,279] [89635] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7ff007f639d0>
[2023-05-13 15:30:34,279] [89635] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 15:30:34,279] [89635] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 15:30:34,279] [89635] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'deepgrow_2d', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 15:30:34,279] [89635] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 15:30:34,279] [89635] [MainThread] [INFO] (lib.trainers.deepgrow:86) - Preparing Dataset for Deepgrow-2D:: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/deepgrow_2d/train_01/cache_20230513_153034/deepgrow_2D_train
[2023-05-13 15:30:34,279] [89635] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:30:34,282] [89635] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 444, in __call__
    datalist = self.pre_process(req, datastore)
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/deepgrow.py", line 88, in pre_process
    datalist = create_dataset(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/apps/deepgrow/dataset.py", line 83, in create_dataset
    raise ValueError("Input datalist is empty")
ValueError: Input datalist is empty
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 15:30:34,648] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 15:30:34,648] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:34,648] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:34,648] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"localization_spine","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 15:30:34,790] [89698] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 15:30:36,370] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 15:30:36,372] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 15:30:36,372] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 15:30:36,373] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 15:30:36,373] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 15:30:36,374] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 15:30:36,374] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 15:30:36,374] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 15:30:36,374] [89698] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 15:30:36,374] [89698] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 15:30:36,418] [89698] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 15:30:36,418] [89698] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 15:30:36,451] [89698] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 15:30:36,525] [89698] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 15:30:36,601] [89698] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 15:30:36,672] [89698] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 15:30:36,672] [89698] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:36,672] [89698] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:36,673] [89698] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 15:30:36,673] [89698] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 15:30:36,673] [89698] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 15:30:36,674] [89698] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 15:30:36,674] [89698] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 15:30:36,674] [89698] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f9eec64c7f0>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f9eec64c790>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f9ee8c85820>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f9ee8c857f0>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f9ee8c85760>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f9eec64c7f0>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f9eec64c790>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f9ee8c85820>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f9ee8c857f0>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f9ee8c85760>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f9ee8c85850>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f9ee8c85880>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f9ee8c858b0>}
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f9ee8c85970>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f9ee8c859a0>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f9ee8c859d0>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f9ee8c85a00>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f9ee8c85a30>
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'localization_spine', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 15:30:36,675] [89698] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'localization_spine', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_153036'}
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_spine/train_01
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_spine/train_01/mlruns;
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: localization_spine; Run Name: run_20230513_153036
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 15:30:36,680] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 15:30:36,683] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_spine.pt
[2023-05-13 15:30:36,684] [89698] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/localization_spine.py", line 70, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 15:30:37,083] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 15:30:37,083] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:37,083] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:37,083] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"localization_vertebra","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 15:30:37,240] [89820] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 15:30:38,748] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 15:30:38,751] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 15:30:38,751] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 15:30:38,752] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 15:30:38,752] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 15:30:38,752] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 15:30:38,752] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 15:30:38,753] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 15:30:38,753] [89820] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 15:30:38,753] [89820] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 15:30:38,794] [89820] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 15:30:38,794] [89820] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 15:30:38,829] [89820] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 15:30:38,905] [89820] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 15:30:38,979] [89820] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 15:30:39,052] [89820] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 15:30:39,052] [89820] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:39,052] [89820] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:39,053] [89820] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 15:30:39,053] [89820] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 15:30:39,053] [89820] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 15:30:39,054] [89820] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 15:30:39,054] [89820] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f8d73ac6790>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f8d73ac6730>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f8d700fd7c0>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f8d700fd790>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f8d700fd700>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f8d73ac6790>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f8d73ac6730>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f8d700fd7c0>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f8d700fd790>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f8d700fd700>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f8d700fd7f0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f8d700fd820>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f8d700fd850>}
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f8d700fd910>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f8d700fd940>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f8d700fd970>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f8d700fd9a0>
[2023-05-13 15:30:39,055] [89820] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f8d700fd9d0>
[2023-05-13 15:30:39,056] [89820] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 15:30:39,056] [89820] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 15:30:39,056] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'localization_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 15:30:39,056] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 15:30:39,056] [89820] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'localization_vertebra', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_153039'}
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_vertebra/train_01
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_vertebra/train_01/mlruns;
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: localization_vertebra; Run Name: run_20230513_153039
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 15:30:39,059] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 15:30:39,061] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_vertebra.pt
[2023-05-13 15:30:39,062] [89820] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/localization_vertebra.py", line 70, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 15:30:39,413] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 15:30:39,414] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:39,414] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 15:30:39,414] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_vertebra","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 15:30:39,557] [89870] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 15:30:41,058] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 15:30:41,061] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 15:30:41,061] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 15:30:41,062] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 15:30:41,062] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 15:30:41,062] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 15:30:41,062] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 15:30:41,062] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 15:30:41,063] [89870] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 15:30:41,063] [89870] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 15:30:41,105] [89870] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 15:30:41,105] [89870] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 15:30:41,139] [89870] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 15:30:41,213] [89870] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 15:30:41,285] [89870] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 15:30:41,356] [89870] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 15:30:41,356] [89870] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:41,356] [89870] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 15:30:41,356] [89870] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 15:30:41,356] [89870] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 15:30:41,356] [89870] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 15:30:41,357] [89870] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 15:30:41,357] [89870] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 15:30:41,358] [89870] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fcd63591850>
[2023-05-13 15:30:41,358] [89870] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7fcd635917f0>
[2023-05-13 15:30:41,358] [89870] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7fcd5fbca880>
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fcd5fbca850>
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fcd5fbca7c0>
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fcd63591850>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7fcd635917f0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7fcd5fbca880>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fcd5fbca850>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fcd5fbca7c0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fcd5fbca8b0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fcd5fbca8e0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7fcd5fbca910>}
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fcd5fbca9d0>
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7fcd5fbcaa00>
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7fcd5fbcaa30>
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7fcd5fbcaa60>
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7fcd5fbcaa90>
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 15:30:41,359] [89870] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:30:41,362] [89870] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 15:30:41,362] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 15:30:41,362] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 15:30:41,362] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_vertebra', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_153041'}
[2023-05-13 15:30:41,362] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 15:30:41,362] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_vertebra/train_01
[2023-05-13 15:30:41,363] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 15:30:41,363] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_vertebra/train_01/mlruns;
[2023-05-13 15:30:41,363] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_vertebra; Run Name: run_20230513_153041
[2023-05-13 15:30:41,363] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 15:30:41,363] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 15:30:41,365] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_segmentation_vertebra.pt
[2023-05-13 15:30:41,366] [89870] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/segmentation_vertebra.py", line 75, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 15:30:41,724] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 15:34:19,913] [89037] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 15:34:20,002] [89037] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[217,36,156,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"judy","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"judy","description":""}]}
[2023-05-13 15:34:20,002] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:34:20,002] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmpbgv9d8vq.bin
[2023-05-13 15:34:20,002] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 15:34:20,002] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [217, 36, 156, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'judy', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'judy', 'description': ''}]}
[2023-05-13 15:34:20,002] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:34:20,002] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 15:34:22,546] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 15:34:22,546] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 15:34:22,546] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 15:34:22,669] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.666287422180176 (sec)
[2023-05-13 15:34:22,677] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmpzjnvidmg.nii.gz
[2023-05-13 15:34:25,391] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => judy
[2023-05-13 15:34:25,391] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "judy",
        "SegmentDescription": "",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "judy"
        },
        "recommendedDisplayRGBValue": [
          217,
          36,
          156
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 15:34:25,392] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmpzjnvidmg.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmpneh_el17.dcm --inputMetadata /tmp/tmpnwfacvmb.json
[2023-05-13 15:34:25,421] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-05-13 15:34:25,694] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-05-13 15:34:25,712] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-05-13 15:34:25,725] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-05-13 15:34:25,772] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-05-13 15:34:25,772] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-05-13 15:34:25,772] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-05-13 15:34:25,772] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-05-13 15:34:25,772] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to judy
[2023-05-13 15:34:25,953] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmpneh_el17.dcm
[2023-05-13 15:34:25,961] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-05-13 15:34:25,961] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.2840797901153564 (sec)
[2023-05-13 15:34:26,065] [89037] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-05-13 15:34:26,267] [89037] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-05-13 15:50:55,432] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 15:50:55,461] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:01:12,413] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:01:12,429] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:01:17,605] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:01:17,606] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:17,607] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'deepgrow_2d', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:01:17,607] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:17,609] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_spleen","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:01:17,609] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'localization_spine', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:01:17,629] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'localization_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:01:17,629] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:01:17,804] [93805] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:01:19,573] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:01:19,576] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:01:19,576] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:01:19,577] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:01:19,577] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:01:19,578] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:01:19,578] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:01:19,578] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:01:19,578] [93805] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:01:19,578] [93805] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:01:19,620] [93805] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:01:19,620] [93805] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:01:19,649] [93805] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:01:19,724] [93805] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:01:19,801] [93805] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:01:19,876] [93805] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:01:19,876] [93805] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:19,876] [93805] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:19,885] [93805] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:01:19,885] [93805] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:01:19,885] [93805] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:01:19,886] [93805] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:01:19,886] [93805] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:01:19,887] [93805] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f390f2517f0>
[2023-05-13 16:01:19,887] [93805] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f390f251790>
[2023-05-13 16:01:19,887] [93805] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f390b88a820>
[2023-05-13 16:01:19,887] [93805] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f390b88a7f0>
[2023-05-13 16:01:19,887] [93805] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f390b88a760>
[2023-05-13 16:01:19,887] [93805] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f390f2517f0>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f390f251790>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f390b88a820>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f390b88a7f0>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f390b88a760>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f390b88a850>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f390b88a880>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f390b88a8b0>}
[2023-05-13 16:01:19,887] [93805] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f390b88a970>
[2023-05-13 16:01:19,887] [93805] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f390b88a9a0>
[2023-05-13 16:01:19,888] [93805] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f390b88a9d0>
[2023-05-13 16:01:19,888] [93805] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f390b88aa00>
[2023-05-13 16:01:19,888] [93805] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f390b88aa30>
[2023-05-13 16:01:19,888] [93805] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:01:19,888] [93805] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:01:19,888] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:01:19,888] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:01:19,888] [93805] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_spleen', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160119'}
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_spleen/train_01
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_spleen/train_01/mlruns;
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_spleen; Run Name: run_20230513_160119
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:01:19,891] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:01:19,893] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_segmentation_spleen.pt
[2023-05-13 16:01:19,894] [93805] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:01:20,299] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:01:20,299] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:20,300] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:20,300] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"deepgrow_2d","name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:01:20,467] [93869] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:01:22,198] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:01:22,202] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:01:22,203] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:01:22,203] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:01:22,204] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:01:22,204] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:01:22,204] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:01:22,204] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:01:22,204] [93869] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:01:22,204] [93869] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:01:22,228] [93869] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:01:22,228] [93869] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:01:22,261] [93869] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:01:22,335] [93869] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:01:22,423] [93869] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:01:22,515] [93869] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:01:22,515] [93869] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:22,515] [93869] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:22,517] [93869] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:01:22,517] [93869] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:01:22,518] [93869] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:01:22,519] [93869] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:01:22,519] [93869] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fe1570de700>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7fe1570de6a0>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7fe153713730>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fe153713700>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fe153713670>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fe1570de700>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7fe1570de6a0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7fe153713730>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fe153713700>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fe153713670>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fe153713760>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fe153713790>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7fe1537137c0>}
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fe153713880>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7fe1537138b0>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7fe1537138e0>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7fe153713910>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7fe153713940>
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:01:22,521] [93869] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:01:22,522] [93869] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'deepgrow_2d', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:01:22,522] [93869] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:01:22,522] [93869] [MainThread] [INFO] (lib.trainers.deepgrow:86) - Preparing Dataset for Deepgrow-2D:: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/deepgrow_2d/train_01/cache_20230513_160122/deepgrow_2D_train
[2023-05-13 16:01:22,522] [93869] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:01:22,526] [93869] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 444, in __call__
    datalist = self.pre_process(req, datastore)
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/deepgrow.py", line 88, in pre_process
    datalist = create_dataset(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/apps/deepgrow/dataset.py", line 83, in create_dataset
    raise ValueError("Input datalist is empty")
ValueError: Input datalist is empty
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:01:22,985] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:01:22,986] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:22,986] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:22,986] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"localization_spine","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:01:23,144] [93917] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:01:24,801] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:01:24,804] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:01:24,804] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:01:24,805] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:01:24,805] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:01:24,805] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:01:24,805] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:01:24,806] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:01:24,806] [93917] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:01:24,806] [93917] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:01:24,828] [93917] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:01:24,829] [93917] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:01:24,859] [93917] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:01:24,929] [93917] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:01:24,998] [93917] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:01:25,068] [93917] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:01:25,068] [93917] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:25,069] [93917] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:25,069] [93917] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:01:25,069] [93917] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:01:25,069] [93917] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:01:25,071] [93917] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:01:25,071] [93917] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:01:25,071] [93917] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f3a3c660820>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f3a3c6607c0>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f3a38c98850>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f3a38c98820>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f3a38c98790>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f3a3c660820>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f3a3c6607c0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f3a38c98850>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f3a38c98820>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f3a38c98790>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f3a38c98880>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f3a38c988b0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f3a38c988e0>}
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f3a38c989a0>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f3a38c989d0>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f3a38c98a00>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f3a38c98a30>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f3a38c98a60>
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'localization_spine', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:01:25,072] [93917] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'localization_spine', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160125'}
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_spine/train_01
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_spine/train_01/mlruns;
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: localization_spine; Run Name: run_20230513_160125
[2023-05-13 16:01:25,075] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:01:25,076] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:01:25,077] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_spine.pt
[2023-05-13 16:01:25,078] [93917] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/localization_spine.py", line 70, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:01:25,485] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:01:25,485] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:25,485] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:25,485] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"localization_vertebra","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:01:25,638] [94001] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:01:27,227] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:01:27,229] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:01:27,229] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:01:27,230] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:01:27,230] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:01:27,231] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:01:27,231] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:01:27,231] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:01:27,231] [94001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:01:27,231] [94001] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:01:27,253] [94001] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:01:27,253] [94001] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:01:27,283] [94001] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:01:27,352] [94001] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:01:27,419] [94001] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:01:27,487] [94001] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:01:27,487] [94001] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:27,487] [94001] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:27,487] [94001] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:01:27,487] [94001] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:01:27,488] [94001] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:01:27,488] [94001] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:01:27,488] [94001] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f6a6c736ac0>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f6a6c736a60>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f6a68d78af0>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f6a68d78ac0>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f6a68d78a30>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f6a6c736ac0>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f6a6c736a60>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f6a68d78af0>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f6a68d78ac0>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f6a68d78a30>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f6a68d78b20>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f6a68d78b50>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f6a68d78b80>}
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f6a68d78c40>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f6a68d78c70>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f6a68d78ca0>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f6a68d78cd0>
[2023-05-13 16:01:27,489] [94001] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f6a68d78d00>
[2023-05-13 16:01:27,490] [94001] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:01:27,490] [94001] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:01:27,490] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'localization_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:01:27,490] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:01:27,490] [94001] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:01:27,492] [94001] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:01:27,492] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:01:27,492] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:01:27,493] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'localization_vertebra', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160127'}
[2023-05-13 16:01:27,493] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:01:27,493] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_vertebra/train_01
[2023-05-13 16:01:27,493] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:01:27,493] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_vertebra/train_01/mlruns;
[2023-05-13 16:01:27,493] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: localization_vertebra; Run Name: run_20230513_160127
[2023-05-13 16:01:27,493] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:01:27,493] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:01:27,495] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_vertebra.pt
[2023-05-13 16:01:27,495] [94001] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/localization_vertebra.py", line 70, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:01:27,833] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:01:27,834] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:27,834] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:01:27,834] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_vertebra","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:01:27,977] [94051] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:01:29,591] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:01:29,594] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:01:29,594] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:01:29,595] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:01:29,595] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:01:29,595] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:01:29,595] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:01:29,596] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:01:29,596] [94051] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:01:29,596] [94051] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:01:29,618] [94051] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:01:29,618] [94051] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:01:29,647] [94051] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:01:29,714] [94051] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:01:29,780] [94051] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:01:29,846] [94051] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:01:29,846] [94051] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:29,846] [94051] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:01:29,847] [94051] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:01:29,847] [94051] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:01:29,847] [94051] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:01:29,848] [94051] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:01:29,848] [94051] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f3f2b26a730>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f3f2b26a6d0>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f3f278a0760>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f3f278a0730>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f3f278a06a0>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f3f2b26a730>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f3f2b26a6d0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f3f278a0760>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f3f278a0730>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f3f278a06a0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f3f278a0790>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f3f278a07c0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f3f278a07f0>}
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f3f278a08b0>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f3f278a08e0>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f3f278a0910>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f3f278a0940>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f3f278a0970>
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:01:29,849] [94051] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_vertebra', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160129'}
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_vertebra/train_01
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_vertebra/train_01/mlruns;
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_vertebra; Run Name: run_20230513_160129
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:01:29,852] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:01:29,854] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_segmentation_vertebra.pt
[2023-05-13 16:01:29,855] [94051] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/segmentation_vertebra.py", line 75, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:01:30,350] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:05:21,565] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:05:21,582] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:05:25,269] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:05:25,269] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:25,269] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'deepgrow_2d', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:05:25,269] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:25,270] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'localization_spine', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:05:25,270] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_spleen","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:05:25,270] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'localization_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:05:25,283] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:05:25,436] [95344] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:05:27,067] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:05:27,070] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:05:27,070] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:05:27,071] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:05:27,071] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:05:27,071] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:05:27,071] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:05:27,072] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:05:27,072] [95344] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:05:27,072] [95344] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:05:27,111] [95344] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:05:27,111] [95344] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:05:27,140] [95344] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:05:27,206] [95344] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:05:27,271] [95344] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:05:27,340] [95344] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:05:27,340] [95344] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:27,340] [95344] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:27,341] [95344] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:05:27,341] [95344] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:05:27,341] [95344] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:05:27,342] [95344] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:05:27,342] [95344] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:05:27,343] [95344] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fe234338730>
[2023-05-13 16:05:27,343] [95344] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7fe2343386d0>
[2023-05-13 16:05:27,343] [95344] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7fe23096e760>
[2023-05-13 16:05:27,343] [95344] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fe23096e730>
[2023-05-13 16:05:27,343] [95344] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fe23096e6a0>
[2023-05-13 16:05:27,343] [95344] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fe234338730>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7fe2343386d0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7fe23096e760>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fe23096e730>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fe23096e6a0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fe23096e790>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fe23096e7c0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7fe23096e7f0>}
[2023-05-13 16:05:27,343] [95344] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fe23096e8b0>
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7fe23096e8e0>
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7fe23096e910>
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7fe23096e940>
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7fe23096e970>
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:05:27,344] [95344] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_spleen', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160527'}
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_spleen/train_01
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_spleen/train_01/mlruns;
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_spleen; Run Name: run_20230513_160527
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:05:27,347] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:05:27,350] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_segmentation_spleen.pt
[2023-05-13 16:05:27,351] [95344] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:05:27,778] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:05:27,778] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:27,778] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:27,778] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"deepgrow_2d","name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:05:27,917] [95403] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:05:29,450] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:05:29,453] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:05:29,453] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:05:29,454] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:05:29,454] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:05:29,454] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:05:29,454] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:05:29,455] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:05:29,455] [95403] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:05:29,455] [95403] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:05:29,495] [95403] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:05:29,496] [95403] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:05:29,525] [95403] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:05:29,591] [95403] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:05:29,658] [95403] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:05:29,724] [95403] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:05:29,724] [95403] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:29,724] [95403] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:29,724] [95403] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:05:29,724] [95403] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:05:29,724] [95403] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:05:29,725] [95403] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:05:29,725] [95403] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f437ce49790>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f437ce49730>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f437947f7c0>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f437947f790>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f437947f700>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f437ce49790>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f437ce49730>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f437947f7c0>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f437947f790>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f437947f700>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f437947f7f0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f437947f820>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f437947f850>}
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f437947f910>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f437947f940>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f437947f970>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f437947f9a0>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f437947f9d0>
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:05:29,726] [95403] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:05:29,727] [95403] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'deepgrow_2d', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:05:29,727] [95403] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:05:29,727] [95403] [MainThread] [INFO] (lib.trainers.deepgrow:86) - Preparing Dataset for Deepgrow-2D:: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/deepgrow_2d/train_01/cache_20230513_160529/deepgrow_2D_train
[2023-05-13 16:05:29,727] [95403] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:05:29,729] [95403] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 444, in __call__
    datalist = self.pre_process(req, datastore)
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/deepgrow.py", line 88, in pre_process
    datalist = create_dataset(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/apps/deepgrow/dataset.py", line 83, in create_dataset
    raise ValueError("Input datalist is empty")
ValueError: Input datalist is empty
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:05:30,058] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:05:30,058] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:30,058] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:30,059] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"localization_spine","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:05:30,202] [95458] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:05:31,928] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:05:31,932] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:05:31,932] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:05:31,933] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:05:31,933] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:05:31,934] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:05:31,934] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:05:31,934] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:05:31,934] [95458] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:05:31,934] [95458] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:05:31,959] [95458] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:05:31,959] [95458] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:05:31,992] [95458] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:05:32,067] [95458] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:05:32,142] [95458] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:05:32,216] [95458] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:05:32,216] [95458] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:32,216] [95458] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:32,217] [95458] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:05:32,217] [95458] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:05:32,217] [95458] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:05:32,218] [95458] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:05:32,218] [95458] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:05:32,219] [95458] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fb88fc59250>
[2023-05-13 16:05:32,219] [95458] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7fb88fc591f0>
[2023-05-13 16:05:32,219] [95458] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7fb88fc68280>
[2023-05-13 16:05:32,219] [95458] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fb88fc68250>
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fb88fc681c0>
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fb88fc59250>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7fb88fc591f0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7fb88fc68280>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fb88fc68250>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fb88fc681c0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fb88fc682b0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fb88fc682e0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7fb88fc68310>}
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fb88fc683d0>
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7fb88fc68400>
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7fb88fc68430>
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7fb88fc68460>
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7fb88fc68490>
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'localization_spine', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:05:32,220] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:05:32,221] [95458] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'localization_spine', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160532'}
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_spine/train_01
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_spine/train_01/mlruns;
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: localization_spine; Run Name: run_20230513_160532
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:05:32,224] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:05:32,226] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_spine.pt
[2023-05-13 16:05:32,227] [95458] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/localization_spine.py", line 70, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:05:32,573] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:05:32,573] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:32,573] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:32,574] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"localization_vertebra","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:05:32,745] [95512] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:05:34,347] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:05:34,350] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:05:34,350] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:05:34,351] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:05:34,351] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:05:34,351] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:05:34,352] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:05:34,352] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:05:34,352] [95512] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:05:34,352] [95512] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:05:34,374] [95512] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:05:34,374] [95512] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:05:34,404] [95512] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:05:34,473] [95512] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:05:34,540] [95512] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:05:34,605] [95512] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:05:34,605] [95512] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:34,605] [95512] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:34,606] [95512] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:05:34,606] [95512] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:05:34,606] [95512] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:05:34,607] [95512] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:05:34,607] [95512] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fe7b2ba1a90>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7fe7b2ba1a30>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7fe7af1e2ac0>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fe7af1e2a90>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fe7af1e2a00>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fe7b2ba1a90>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7fe7b2ba1a30>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7fe7af1e2ac0>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fe7af1e2a90>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fe7af1e2a00>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fe7af1e2af0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fe7af1e2b20>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7fe7af1e2b50>}
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fe7af1e2c10>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7fe7af1e2c40>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7fe7af1e2c70>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7fe7af1e2ca0>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7fe7af1e2cd0>
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'localization_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:05:34,608] [95512] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'localization_vertebra', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160534'}
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_vertebra/train_01
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_vertebra/train_01/mlruns;
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: localization_vertebra; Run Name: run_20230513_160534
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:05:34,611] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:05:34,613] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_vertebra.pt
[2023-05-13 16:05:34,614] [95512] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/localization_vertebra.py", line 70, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:05:34,954] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:05:34,955] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:34,955] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:05:34,955] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_vertebra","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:05:35,093] [95584] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:05:36,632] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:05:36,634] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:05:36,634] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:05:36,635] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:05:36,635] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:05:36,636] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:05:36,636] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:05:36,636] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:05:36,636] [95584] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:05:36,636] [95584] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:05:36,659] [95584] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:05:36,659] [95584] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:05:36,690] [95584] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:05:36,757] [95584] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:05:36,823] [95584] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:05:36,891] [95584] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:05:36,891] [95584] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:36,891] [95584] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:05:36,892] [95584] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:05:36,892] [95584] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:05:36,892] [95584] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:05:36,892] [95584] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:05:36,893] [95584] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:05:36,893] [95584] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f39001d3730>
[2023-05-13 16:05:36,893] [95584] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f39001d36d0>
[2023-05-13 16:05:36,893] [95584] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f38fc809760>
[2023-05-13 16:05:36,893] [95584] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f38fc809730>
[2023-05-13 16:05:36,893] [95584] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f38fc8096a0>
[2023-05-13 16:05:36,893] [95584] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f39001d3730>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f39001d36d0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f38fc809760>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f38fc809730>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f38fc8096a0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f38fc809790>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f38fc8097c0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f38fc8097f0>}
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f38fc8098b0>
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f38fc8098e0>
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f38fc809910>
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f38fc809940>
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f38fc809970>
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:05:36,894] [95584] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_vertebra', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160536'}
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_vertebra/train_01
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_vertebra/train_01/mlruns;
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_vertebra; Run Name: run_20230513_160536
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:05:36,897] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:05:36,899] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_segmentation_vertebra.pt
[2023-05-13 16:05:36,900] [95584] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/segmentation_vertebra.py", line 75, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:05:37,243] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:06:26,560] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:06:26,560] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:26,560] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'deepgrow_2d', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:06:26,560] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:26,561] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'localization_spine', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:06:26,561] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_spleen","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:06:26,561] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'localization_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:06:26,573] [89037] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'segmentation_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}}
[2023-05-13 16:06:26,725] [96573] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:06:28,406] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:06:28,409] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:06:28,409] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:06:28,410] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:06:28,410] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:06:28,410] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:06:28,410] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:06:28,411] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:06:28,411] [96573] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:06:28,411] [96573] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:06:28,434] [96573] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:06:28,434] [96573] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:06:28,468] [96573] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:06:28,547] [96573] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:06:28,628] [96573] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:06:28,711] [96573] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:06:28,711] [96573] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:28,711] [96573] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:28,712] [96573] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:06:28,712] [96573] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:06:28,713] [96573] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:06:28,714] [96573] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:06:28,714] [96573] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:06:28,715] [96573] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7ff6f6e9ea60>
[2023-05-13 16:06:28,715] [96573] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7ff6f6e9ea00>
[2023-05-13 16:06:28,715] [96573] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7ff6f34dda90>
[2023-05-13 16:06:28,715] [96573] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7ff6f34dda60>
[2023-05-13 16:06:28,715] [96573] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7ff6f34dd9d0>
[2023-05-13 16:06:28,715] [96573] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7ff6f6e9ea60>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7ff6f6e9ea00>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7ff6f34dda90>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7ff6f34dda60>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7ff6f34dd9d0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7ff6f34ddac0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7ff6f34ddaf0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7ff6f34ddb20>}
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7ff6f34ddbe0>
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7ff6f34ddc10>
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7ff6f34ddc40>
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7ff6f34ddc70>
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7ff6f34ddca0>
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_spleen', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:06:28,716] [96573] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_spleen', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160628'}
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_spleen/train_01
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_spleen/train_01/mlruns;
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_spleen; Run Name: run_20230513_160628
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:06:28,721] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:06:28,724] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_segmentation_spleen.pt
[2023-05-13 16:06:28,725] [96573] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:06:29,240] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:06:29,240] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:29,240] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:29,240] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"deepgrow_2d","name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:06:29,390] [96637] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:06:30,965] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:06:30,968] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:06:30,968] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:06:30,969] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:06:30,969] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:06:30,969] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:06:30,969] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:06:30,969] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:06:30,969] [96637] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:06:30,970] [96637] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:06:30,992] [96637] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:06:30,992] [96637] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:06:31,022] [96637] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:06:31,087] [96637] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:06:31,153] [96637] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:06:31,218] [96637] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:06:31,218] [96637] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:31,218] [96637] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:31,218] [96637] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:06:31,218] [96637] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:06:31,219] [96637] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:06:31,227] [96637] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:06:31,227] [96637] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fbc009cfbe0>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7fbc009cfb80>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7fbbfd015c10>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fbbfd015be0>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fbbfd015b50>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fbc009cfbe0>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7fbc009cfb80>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7fbbfd015c10>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7fbbfd015be0>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7fbbfd015b50>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fbbfd015c40>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fbbfd015c70>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7fbbfd015ca0>}
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fbbfd015d60>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7fbbfd015d90>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7fbbfd015dc0>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7fbbfd015df0>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7fbbfd015e20>
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:06:31,228] [96637] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'deepgrow_2d', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:06:31,229] [96637] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:06:31,229] [96637] [MainThread] [INFO] (lib.trainers.deepgrow:86) - Preparing Dataset for Deepgrow-2D:: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/deepgrow_2d/train_01/cache_20230513_160631/deepgrow_2D_train
[2023-05-13 16:06:31,229] [96637] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:06:31,231] [96637] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 444, in __call__
    datalist = self.pre_process(req, datastore)
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/deepgrow.py", line 88, in pre_process
    datalist = create_dataset(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/apps/deepgrow/dataset.py", line 83, in create_dataset
    raise ValueError("Input datalist is empty")
ValueError: Input datalist is empty
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:06:31,575] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:06:31,576] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:31,576] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:31,576] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"localization_spine","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:06:31,717] [96685] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:06:33,286] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:06:33,289] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:06:33,289] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:06:33,290] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:06:33,290] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:06:33,290] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:06:33,290] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:06:33,290] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:06:33,291] [96685] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:06:33,291] [96685] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:06:33,331] [96685] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:06:33,332] [96685] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:06:33,360] [96685] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:06:33,426] [96685] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:06:33,492] [96685] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:06:33,557] [96685] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:06:33,557] [96685] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:33,557] [96685] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:33,558] [96685] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:06:33,558] [96685] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:06:33,558] [96685] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:06:33,559] [96685] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:06:33,559] [96685] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f9a21809940>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f9a218098e0>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f9a1de47970>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f9a1de47940>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f9a1de478b0>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f9a21809940>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f9a218098e0>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f9a1de47970>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f9a1de47940>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f9a1de478b0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f9a1de479a0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f9a1de479d0>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f9a1de47a00>}
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f9a1de47ac0>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f9a1de47af0>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f9a1de47b20>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f9a1de47b50>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f9a1de47b80>
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'localization_spine', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:06:33,560] [96685] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'localization_spine', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160633'}
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_spine/train_01
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_spine/train_01/mlruns;
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: localization_spine; Run Name: run_20230513_160633
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:06:33,563] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:06:33,565] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_spine.pt
[2023-05-13 16:06:33,566] [96685] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/localization_spine.py", line 70, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:06:33,905] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:06:33,906] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:33,906] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:33,906] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"localization_vertebra","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:06:34,043] [96750] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:06:35,578] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:06:35,580] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:06:35,581] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:06:35,581] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:06:35,582] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:06:35,582] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:06:35,582] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:06:35,582] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:06:35,582] [96750] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:06:35,582] [96750] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:06:35,623] [96750] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:06:35,623] [96750] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:06:35,652] [96750] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:06:35,717] [96750] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:06:35,783] [96750] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:06:35,848] [96750] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:06:35,848] [96750] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:35,848] [96750] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:35,849] [96750] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:06:35,849] [96750] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:06:35,849] [96750] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:06:35,850] [96750] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:06:35,850] [96750] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f453acc86d0>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f453acc8670>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f45372fe700>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f45372fe6d0>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f45372fe640>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f453acc86d0>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f453acc8670>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f45372fe700>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f45372fe6d0>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f45372fe640>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f45372fe730>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f45372fe760>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f45372fe790>}
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f45372fe850>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f45372fe880>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f45372fe8b0>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f45372fe8e0>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f45372fe910>
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'localization_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:06:35,851] [96750] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'localization_vertebra', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160635'}
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_vertebra/train_01
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/localization_vertebra/train_01/mlruns;
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: localization_vertebra; Run Name: run_20230513_160635
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:06:35,854] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:06:35,856] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_vertebra.pt
[2023-05-13 16:06:35,857] [96750] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/localization_vertebra.py", line 70, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:06:36,219] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:06:36,219] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:36,219] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /home/ndvinh/Desktop/KLTN/KTTN:
[2023-05-13 16:06:36,219] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /home/ndvinh/anaconda3/envs/monailabel-dev-env/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"segmentation_vertebra","name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":"","segmentation_spleen":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"deepgrow_2d":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":10,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":16,"val_batch_size":16,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_spine":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"localization_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""},"segmentation_vertebra":{"name":"train_01","pretrained":true,"device":"cuda","max_epochs":50,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":["SmartCacheDataset","CacheDataset","PersistentDataset","Dataset"],"dataloader":["ThreadDataLoader","DataLoader"],"tracking":["mlflow","None"],"tracking_uri":"","tracking_experiment_name":""}}
[2023-05-13 16:06:36,363] [96800] [MainThread] [INFO] (__main__:37) - Initializing App from: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen,deepgrow_2d,localization_spine,localization_vertebra,segmentation_vertebra'}
[2023-05-13 16:06:38,032] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-13 16:06:38,035] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-13 16:06:38,036] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-13 16:06:38,036] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-13 16:06:38,037] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-13 16:06:38,037] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-13 16:06:38,037] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-13 16:06:38,037] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-13 16:06:38,037] [96800] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-13 16:06:38,037] [96800] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-13 16:06:38,078] [96800] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-13 16:06:38,078] [96800] [MainThread] [INFO] (main:93) - +++ Adding Model: deepgrow_2d => lib.configs.deepgrow_2d.Deepgrow2D
[2023-05-13 16:06:38,111] [96800] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_spine => lib.configs.localization_spine.LocalizationSpine
[2023-05-13 16:06:38,185] [96800] [MainThread] [INFO] (main:93) - +++ Adding Model: localization_vertebra => lib.configs.localization_vertebra.LocalizationVertebra
[2023-05-13 16:06:38,253] [96800] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_vertebra => lib.configs.segmentation_vertebra.SegmentationVertebra
[2023-05-13 16:06:38,319] [96800] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen', 'deepgrow_2d', 'localization_spine', 'localization_vertebra', 'segmentation_vertebra']
[2023-05-13 16:06:38,319] [96800] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:38,319] [96800] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-13 16:06:38,319] [96800] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-13 16:06:38,319] [96800] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-13 16:06:38,320] [96800] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-13 16:06:38,320] [96800] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-13 16:06:38,320] [96800] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-13 16:06:38,321] [96800] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f4b8b3258e0>
[2023-05-13 16:06:38,321] [96800] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: deepgrow_2d => <lib.infers.deepgrow.Deepgrow object at 0x7f4b8b325880>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_spine => <lib.infers.localization_spine.LocalizationSpine object at 0x7f4b87960910>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: localization_vertebra => <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f4b879608e0>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_vertebra => <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f4b87960850>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f4b8b3258e0>, 'deepgrow_2d': <lib.infers.deepgrow.Deepgrow object at 0x7f4b8b325880>, 'localization_spine': <lib.infers.localization_spine.LocalizationSpine object at 0x7f4b87960910>, 'localization_vertebra': <lib.infers.localization_vertebra.LocalizationVertebra object at 0x7f4b879608e0>, 'segmentation_vertebra': <lib.infers.segmentation_vertebra.SegmentationVertebra object at 0x7f4b87960850>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f4b87960940>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f4b87960970>, 'vertebra_pipeline': <lib.infers.vertebra_pipeline.InferVertebraPipeline object at 0x7f4b879609a0>}
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f4b87960a60>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: deepgrow_2d => <lib.trainers.deepgrow.Deepgrow object at 0x7f4b87960a90>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_spine => <lib.trainers.localization_spine.LocalizationSpine object at 0x7f4b87960ac0>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: localization_vertebra => <lib.trainers.localization_vertebra.LocalizationVertebra object at 0x7f4b87960af0>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_vertebra => <lib.trainers.segmentation_vertebra.SegmentationVertebra object at 0x7f4b87960b20>
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndvinh/.cache/monailabel/sessions
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:432) - Train Request (input): {'model': 'segmentation_vertebra', 'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0}
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:442) - CUDA_VISIBLE_DEVICES: None
[2023-05-13 16:06:38,322] [96800] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.datastore.dicom:239) - Invalid Labels: set()
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:447) - Distributed/Multi GPU is limited
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:462) - Distributed Training = FALSE
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:489) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': False, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'segmentation_vertebra', 'segmentation_spleen': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'deepgrow_2d': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 10, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 16, 'val_batch_size': 16, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_spine': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'localization_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'segmentation_vertebra': {'name': 'train_01', 'pretrained': True, 'device': 'cuda', 'max_epochs': 50, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': ['SmartCacheDataset', 'CacheDataset', 'PersistentDataset', 'Dataset'], 'dataloader': ['ThreadDataLoader', 'DataLoader'], 'tracking': ['mlflow', 'None'], 'tracking_uri': '', 'tracking_experiment_name': ''}, 'local_rank': 0, 'run_id': '20230513_160638'}
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:622) - 0 - Using Device: cpu; IDX: None
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:515) - Run/Output Path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_vertebra/train_01
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:531) - Tracking: mlflow
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:532) - Tracking URI: file:///home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/segmentation_vertebra/train_01/mlruns;
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:533) - Tracking Experiment Name: segmentation_vertebra; Run Name: run_20230513_160638
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:410) - Total Records for Training: 0
[2023-05-13 16:06:38,325] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:411) - Total Records for Validation: 0
[2023-05-13 16:06:38,327] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:710) - 0 - Load Path /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_segmentation_vertebra.pt
[2023-05-13 16:06:38,328] [96800] [MainThread] [INFO] (monailabel.tasks.train.basic_train:264) - 0 - Records for Training: 0
Traceback (most recent call last):
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 128, in <module>
    run_main()
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/utils/app.py", line 113, in run_main
    result = a.train(request)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/interfaces/app.py", line 422, in train
    result = task(request, self.datastore())
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 463, in __call__
    res = self.train(0, world_size, req, datalist)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 541, in train
    context.trainer = self._create_trainer(context)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 693, in _create_trainer
    train_data_loader=self.train_data_loader(context),
  File "/home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/lib/trainers/segmentation_vertebra.py", line 75, in train_data_loader
    return super().train_data_loader(context, num_workers, True)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 267, in train_data_loader
    return self._dataloader(context, dataset, context.train_batch_size, num_workers, shuffle)
  File "/home/ndvinh/Desktop/KLTN/KTTN/monailabel/tasks/train/basic_train.py", line 255, in _dataloader
    return DataLoader(
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/monai/data/dataloader.py", line 89, in __init__
    super().__init__(dataset=dataset, num_workers=num_workers, **kwargs)
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 344, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/ndvinh/anaconda3/envs/monailabel-dev-env/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 107, in __init__
    raise ValueError("num_samples should be a positive integer "
ValueError: num_samples should be a positive integer value, but got num_samples=0
BasicUNet features: (32, 64, 128, 256, 512, 32).
[2023-05-13 16:06:38,667] [89037] [ThreadPoolExecutor-2_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2023-05-13 16:26:47,296] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:26:47,312] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:34:50,378] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:34:50,398] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:35:08,944] [89037] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 16:35:09,029] [89037] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[234,30,248,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"bryan","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"bryan","description":""}]}
[2023-05-13 16:35:09,029] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:35:09,029] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmpnh0b1yfn.bin
[2023-05-13 16:35:09,029] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 16:35:09,029] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [234, 30, 248, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'bryan', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'bryan', 'description': ''}]}
[2023-05-13 16:35:09,029] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:35:09,029] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:35:11,458] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 16:35:11,459] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 16:35:11,459] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 16:35:11,816] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 2.786062717437744 (sec)
[2023-05-13 16:35:11,825] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmp_2dx7pie.nii.gz
[2023-05-13 16:35:15,649] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => bryan
[2023-05-13 16:35:15,649] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "bryan",
        "SegmentDescription": "",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "bryan"
        },
        "recommendedDisplayRGBValue": [
          234,
          30,
          248
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 16:35:15,649] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmp_2dx7pie.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmp9g378s4p.dcm --inputMetadata /tmp/tmp5c56glf_.json
[2023-05-13 16:35:15,679] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-05-13 16:35:15,963] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-05-13 16:35:15,984] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-05-13 16:35:16,009] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-05-13 16:35:16,048] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-05-13 16:35:16,048] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-05-13 16:35:16,048] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-05-13 16:35:16,048] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-05-13 16:35:16,048] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to bryan
[2023-05-13 16:35:16,237] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmp9g378s4p.dcm
[2023-05-13 16:35:16,245] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-05-13 16:35:16,246] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 4.4203033447265625 (sec)
[2023-05-13 16:35:16,368] [89037] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-05-13 16:35:16,444] [89037] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-05-13 16:48:40,235] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:48:40,253] [89037] [MainThread] [INFO] (dicomweb_client.web:2203) - search for series
[2023-05-13 16:48:46,308] [89037] [MainThread] [INFO] (monailabel.endpoints.infer:160) - Infer Request: {'model': 'localization_spine', 'image': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423', 'device': ['cpu'], 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False}
[2023-05-13 16:48:46,308] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:48:46,309] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:48:46,312] [89037] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:279) - Infer Request (final): {'device': 'cpu', 'model': 'localization_spine', 'image': '/home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint16', 'result_compress': False, 'description': 'A pre-trained model for volumetric (3D) spine localization from CT image'}
[2023-05-13 16:48:46,322] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2023-05-13 16:48:46,323] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path']
[2023-05-13 16:48:48,747] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 2.4237; image: torch.Size([512, 512, 301])(torch.float32)
[2023-05-13 16:48:48,747] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([512, 512, 301])(torch.float32)
[2023-05-13 16:48:48,749] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0018; image: torch.Size([1, 512, 512, 301])(torch.float32)
[2023-05-13 16:48:48,785] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (CacheObjectd): Time: 0.036; image: torch.Size([1, 512, 512, 301])(torch.float32)
[2023-05-13 16:48:49,704] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.9188; image: torch.Size([1, 320, 320, 232])(torch.float32)
[2023-05-13 16:48:49,778] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0729; image: torch.Size([1, 320, 320, 232])(torch.float32)
[2023-05-13 16:48:50,217] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (GaussianSmoothd): Time: 0.4391; image: torch.Size([1, 320, 320, 232])(torch.float32)
[2023-05-13 16:48:50,283] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityd): Time: 0.066; image: torch.Size([1, 320, 320, 232])(torch.float32)
[2023-05-13 16:48:50,283] [89037] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:471) - Inferer:: cpu => SlidingWindowInferer => {'roi_size': (96, 96, 96), 'sw_batch_size': 2, 'overlap': 0.4, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': 'replicate', 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'roi_weight_map': None}
[2023-05-13 16:48:50,283] [89037] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:420) - Infer model path: /home/ndvinh/Desktop/KLTN/KTTN/apps/radiology/model/pretrained_localization_spine.pt
[2023-05-13 16:51:07,040] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2023-05-13 16:51:07,040] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'result_compress', 'description', 'image_path', 'image_meta_dict', 'latencies', 'image_cached', 'pred']
[2023-05-13 16:51:07,041] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 320, 320, 232])(torch.float32); pred: torch.Size([25, 320, 320, 232])(torch.float32)
[2023-05-13 16:51:07,307] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.2651; image: torch.Size([1, 320, 320, 232])(torch.float32); pred: torch.Size([25, 320, 320, 232])(torch.float32)
[2023-05-13 16:51:09,167] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 1.8604; image: torch.Size([1, 320, 320, 232])(torch.float32); pred: torch.Size([1, 320, 320, 232])(torch.float32)
[2023-05-13 16:51:10,849] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (KeepLargestConnectedComponentd): Time: 1.681; image: torch.Size([1, 320, 320, 232])(torch.float32); pred: torch.Size([1, 320, 320, 232])(torch.float32)
[2023-05-13 16:51:10,866] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (BinaryMaskd): Time: 0.0172; image: torch.Size([1, 320, 320, 232])(torch.float32); pred: torch.Size([1, 320, 320, 232])(torch.float32)
[2023-05-13 16:51:10,964] [89037] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0975; image: torch.Size([1, 320, 320, 232])(torch.float32); pred: torch.Size([512, 512, 301])(torch.float32)
[2023-05-13 16:51:11,035] [89037] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:571) - Writing Result...
[2023-05-13 16:51:11,035] [89037] [MainThread] [INFO] (monailabel.transform.writer:189) - Result ext: .nrrd; write_to_file: True; dtype: uint16
[2023-05-13 16:51:11,542] [89037] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:334) - ++ Latencies => Total: 145.2317; Pre: 3.9714; Inferer: 136.7560; Invert: 0.0000; Post: 3.9952; Write: 0.5073
[2023-05-13 16:51:11,542] [89037] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:358) - Result File: /tmp/tmpffw71svx.nrrd
[2023-05-13 16:51:11,542] [89037] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:359) - Result Json Keys: ['label_names', 'latencies']
[2023-05-13 16:55:41,710] [89037] [MainThread] [INFO] (monailabel.endpoints.datastore:100) - Saving Label for 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for tag: final by admin
[2023-05-13 16:55:41,806] [89037] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info":[{"id":"0+1","labelmapIndex":0,"segmentIndex":1,"color":[221.33999999999997,84.66000000000001,84.66000000000001,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":1,"SegmentLabel":"C1","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"C1","description":""},{"id":"0+2","labelmapIndex":0,"segmentIndex":2,"color":[77.52,228.48,121.54999999999998,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":2,"SegmentLabel":"C2","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"C2","description":""},{"id":"0+3","labelmapIndex":0,"segmentIndex":3,"color":[166.76999999999995,70.37999999999998,235.62,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":3,"SegmentLabel":"C3","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"C3","description":""},{"id":"0+4","labelmapIndex":0,"segmentIndex":4,"color":[189.72,180.54,116.27999999999997,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":4,"SegmentLabel":"C4","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"C4","description":""},{"id":"0+5","labelmapIndex":0,"segmentIndex":5,"color":[109.13999999999999,182.24000000000004,196.86,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":5,"SegmentLabel":"C5","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"C5","description":""},{"id":"0+6","labelmapIndex":0,"segmentIndex":6,"color":[204,101.99999999999997,157.25000000000003,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":6,"SegmentLabel":"C6","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"C6","description":""},{"id":"0+7","labelmapIndex":0,"segmentIndex":7,"color":[123.92999999999998,211.14000000000001,94.85999999999997,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":7,"SegmentLabel":"C7","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"C7","description":""},{"id":"0+8","labelmapIndex":0,"segmentIndex":8,"color":[93.15999999999998,87.71999999999996,218.28000000000003,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":8,"SegmentLabel":"Th1","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th1","description":""},{"id":"0+9","labelmapIndex":0,"segmentIndex":9,"color":[225.42000000000004,128.85999999999996,80.57999999999994,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":9,"SegmentLabel":"Th2","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th2","description":""},{"id":"0+10","labelmapIndex":0,"segmentIndex":10,"color":[73.43999999999994,232.56000000000003,172.89000000000001,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":10,"SegmentLabel":"Th3","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th3","description":""},{"id":"0+11","labelmapIndex":0,"segmentIndex":11,"color":[181.05000000000004,119.33999999999993,186.66000000000005,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":11,"SegmentLabel":"Th4","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th4","description":""},{"id":"0+12","labelmapIndex":0,"segmentIndex":12,"color":[176.80000000000004,193.80000000000007,112.19999999999993,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":12,"SegmentLabel":"Th5","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th5","description":""},{"id":"0+13","labelmapIndex":0,"segmentIndex":13,"color":[105.05999999999992,153,200.94000000000005,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":13,"SegmentLabel":"Th6","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th6","description":""},{"id":"0+14","labelmapIndex":0,"segmentIndex":14,"color":[208.08000000000007,97.91999999999993,120.86999999999992,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":14,"SegmentLabel":"Th7","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th7","description":""},{"id":"0+15","labelmapIndex":0,"segmentIndex":15,"color":[90.77999999999994,215.22000000000006,101.14999999999998,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":15,"SegmentLabel":"Th8","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th8","description":""},{"id":"0+16","labelmapIndex":0,"segmentIndex":16,"color":[135.65999999999997,83.63999999999993,222.36000000000004,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":16,"SegmentLabel":"Th9","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th9","description":""},{"id":"0+17","labelmapIndex":0,"segmentIndex":17,"color":[229.50000000000006,178.50000000000003,76.49999999999993,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":17,"SegmentLabel":"Th10","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th10","description":""},{"id":"0+18","labelmapIndex":0,"segmentIndex":18,"color":[122.3999999999999,183.60000000000008,181.05000000000007,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":18,"SegmentLabel":"Th11","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th11","description":""},{"id":"0+19","labelmapIndex":0,"segmentIndex":19,"color":[190.74000000000007,115.2599999999999,171.87000000000003,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":19,"SegmentLabel":"Th12","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"Th12","description":""},{"id":"0+20","labelmapIndex":0,"segmentIndex":20,"color":[149.26,197.88000000000005,108.1199999999999,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":20,"SegmentLabel":"L1","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"L1","description":""},{"id":"0+21","labelmapIndex":0,"segmentIndex":21,"color":[100.97999999999992,118.31999999999994,205.02000000000007,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":21,"SegmentLabel":"L2","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"L2","description":""},{"id":"0+22","labelmapIndex":0,"segmentIndex":22,"color":[212.16000000000008,108.62999999999992,93.83999999999992,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":22,"SegmentLabel":"L3","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"L3","description":""},{"id":"0+23","labelmapIndex":0,"segmentIndex":23,"color":[86.6999999999999,219.30000000000007,141.94999999999996,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":23,"SegmentLabel":"L4","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"L4","description":""},{"id":"0+24","labelmapIndex":0,"segmentIndex":24,"color":[183.6,79.5599999999999,226.44000000000008,255],"meta":{"SegmentedPropertyCategoryCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"},"SegmentNumber":24,"SegmentLabel":"L5","SegmentDescription":"","SegmentAlgorithmType":"SEMIAUTOMATIC","SegmentAlgorithmName":"MONAI","SegmentedPropertyTypeCodeSequence":{"CodeValue":"T-D0050","CodingSchemeDesignator":"SRT","CodeMeaning":"Tissue"}},"name":"L5","description":""}]}
[2023-05-13 16:55:41,806] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:176) - Input - Image Id: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:55:41,806] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:177) - Input - Label File: /tmp/tmp7dsfg_go.bin
[2023-05-13 16:55:41,806] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:178) - Input - Label Tag: final
[2023-05-13 16:55:41,807] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:179) - Input - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [221.33999999999997, 84.66000000000001, 84.66000000000001, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'C1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C1', 'description': ''}, {'id': '0+2', 'labelmapIndex': 0, 'segmentIndex': 2, 'color': [77.52, 228.48, 121.54999999999998, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'C2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C2', 'description': ''}, {'id': '0+3', 'labelmapIndex': 0, 'segmentIndex': 3, 'color': [166.76999999999995, 70.37999999999998, 235.62, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'C3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C3', 'description': ''}, {'id': '0+4', 'labelmapIndex': 0, 'segmentIndex': 4, 'color': [189.72, 180.54, 116.27999999999997, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 4, 'SegmentLabel': 'C4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C4', 'description': ''}, {'id': '0+5', 'labelmapIndex': 0, 'segmentIndex': 5, 'color': [109.13999999999999, 182.24000000000004, 196.86, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 5, 'SegmentLabel': 'C5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C5', 'description': ''}, {'id': '0+6', 'labelmapIndex': 0, 'segmentIndex': 6, 'color': [204, 101.99999999999997, 157.25000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 6, 'SegmentLabel': 'C6', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C6', 'description': ''}, {'id': '0+7', 'labelmapIndex': 0, 'segmentIndex': 7, 'color': [123.92999999999998, 211.14000000000001, 94.85999999999997, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 7, 'SegmentLabel': 'C7', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C7', 'description': ''}, {'id': '0+8', 'labelmapIndex': 0, 'segmentIndex': 8, 'color': [93.15999999999998, 87.71999999999996, 218.28000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 8, 'SegmentLabel': 'Th1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th1', 'description': ''}, {'id': '0+9', 'labelmapIndex': 0, 'segmentIndex': 9, 'color': [225.42000000000004, 128.85999999999996, 80.57999999999994, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 9, 'SegmentLabel': 'Th2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th2', 'description': ''}, {'id': '0+10', 'labelmapIndex': 0, 'segmentIndex': 10, 'color': [73.43999999999994, 232.56000000000003, 172.89000000000001, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 10, 'SegmentLabel': 'Th3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th3', 'description': ''}, {'id': '0+11', 'labelmapIndex': 0, 'segmentIndex': 11, 'color': [181.05000000000004, 119.33999999999993, 186.66000000000005, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 11, 'SegmentLabel': 'Th4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th4', 'description': ''}, {'id': '0+12', 'labelmapIndex': 0, 'segmentIndex': 12, 'color': [176.80000000000004, 193.80000000000007, 112.19999999999993, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 12, 'SegmentLabel': 'Th5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th5', 'description': ''}, {'id': '0+13', 'labelmapIndex': 0, 'segmentIndex': 13, 'color': [105.05999999999992, 153, 200.94000000000005, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 13, 'SegmentLabel': 'Th6', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th6', 'description': ''}, {'id': '0+14', 'labelmapIndex': 0, 'segmentIndex': 14, 'color': [208.08000000000007, 97.91999999999993, 120.86999999999992, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 14, 'SegmentLabel': 'Th7', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th7', 'description': ''}, {'id': '0+15', 'labelmapIndex': 0, 'segmentIndex': 15, 'color': [90.77999999999994, 215.22000000000006, 101.14999999999998, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 15, 'SegmentLabel': 'Th8', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th8', 'description': ''}, {'id': '0+16', 'labelmapIndex': 0, 'segmentIndex': 16, 'color': [135.65999999999997, 83.63999999999993, 222.36000000000004, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 16, 'SegmentLabel': 'Th9', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th9', 'description': ''}, {'id': '0+17', 'labelmapIndex': 0, 'segmentIndex': 17, 'color': [229.50000000000006, 178.50000000000003, 76.49999999999993, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 17, 'SegmentLabel': 'Th10', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th10', 'description': ''}, {'id': '0+18', 'labelmapIndex': 0, 'segmentIndex': 18, 'color': [122.3999999999999, 183.60000000000008, 181.05000000000007, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 18, 'SegmentLabel': 'Th11', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th11', 'description': ''}, {'id': '0+19', 'labelmapIndex': 0, 'segmentIndex': 19, 'color': [190.74000000000007, 115.2599999999999, 171.87000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 19, 'SegmentLabel': 'Th12', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th12', 'description': ''}, {'id': '0+20', 'labelmapIndex': 0, 'segmentIndex': 20, 'color': [149.26, 197.88000000000005, 108.1199999999999, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 20, 'SegmentLabel': 'L1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L1', 'description': ''}, {'id': '0+21', 'labelmapIndex': 0, 'segmentIndex': 21, 'color': [100.97999999999992, 118.31999999999994, 205.02000000000007, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 21, 'SegmentLabel': 'L2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L2', 'description': ''}, {'id': '0+22', 'labelmapIndex': 0, 'segmentIndex': 22, 'color': [212.16000000000008, 108.62999999999992, 93.83999999999992, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 22, 'SegmentLabel': 'L3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L3', 'description': ''}, {'id': '0+23', 'labelmapIndex': 0, 'segmentIndex': 23, 'color': [86.6999999999999, 219.30000000000007, 141.94999999999996, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 23, 'SegmentLabel': 'L4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L4', 'description': ''}, {'id': '0+24', 'labelmapIndex': 0, 'segmentIndex': 24, 'color': [183.6, 79.5599999999999, 226.44000000000008, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 24, 'SegmentLabel': 'L5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L5', 'description': ''}]}
[2023-05-13 16:55:41,807] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:78) - Image ID: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:55:41,807] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:80) - Image Dir (cache): /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:55:44,686] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:70) - Image: torch.Size([512, 512, 301])
[2023-05-13 16:55:44,687] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:71) - Label: (78905344,)
[2023-05-13 16:55:44,687] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:74) - Label (reshape): (512, 512, 301)
[2023-05-13 16:55:44,830] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:83) - binary_to_image latency : 3.021629571914673 (sec)
[2023-05-13 16:55:44,831] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:189) - Label File: /tmp/tmp6engzpx6.nii.gz
[2023-05-13 16:55:47,349] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:102) - 0 => 1 => C1
[2023-05-13 16:55:47,349] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:141) - {
  "ContentCreatorName": "Reader1",
  "ClinicalTrialSeriesID": "Session1",
  "ClinicalTrialTimePointID": "1",
  "SeriesDescription": "Segmentation",
  "SeriesNumber": "300",
  "InstanceNumber": "1",
  "segmentAttributes": [
    [
      {
        "labelID": 1,
        "SegmentLabel": "C1",
        "SegmentDescription": "",
        "SegmentAlgorithmType": "AUTOMATIC",
        "SegmentAlgorithmName": "MONAILABEL",
        "SegmentedPropertyCategoryCodeSequence": {
          "CodeValue": "123037004",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "Anatomical Structure"
        },
        "SegmentedPropertyTypeCodeSequence": {
          "CodeValue": "78961009",
          "CodingSchemeDesignator": "SCT",
          "CodeMeaning": "C1"
        },
        "recommendedDisplayRGBValue": [
          221,
          84,
          84
        ]
      }
    ]
  ],
  "ContentLabel": "SEGMENTATION",
  "ContentDescription": "MONAI Label - Image segmentation",
  "ClinicalTrialCoordinatingCenterName": "MONAI",
  "BodyPartExamined": ""
}
[2023-05-13 16:55:47,350] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:74) - Running Command:: itkimage2segimage --inputImageList /tmp/tmp6engzpx6.nii.gz --inputDICOMDirectory /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 --outputDICOM /tmp/tmpl8kvkdb7.dcm --inputMetadata /tmp/tmph0091hc6.json
[2023-05-13 16:55:47,403] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - dcmqi repository URL: git@github.com:QIICR/dcmqi.git revision: ef9e227 tag: v1.2.4
[2023-05-13 16:55:47,695] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Searching recursively /home/ndvinh/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35/1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 for DICOM files
[2023-05-13 16:55:47,821] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - 301 of 301 slices mapped to source DICOM images
[2023-05-13 16:55:47,842] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Found 2 label(s)
[2023-05-13 16:55:47,913] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Skipping label 0
[2023-05-13 16:55:47,913] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Processing label 1
[2023-05-13 16:55:47,913] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Total non-empty slices that will be encoded in SEG for label 1 is 301
[2023-05-13 16:55:47,913] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) -  (inclusive from 0 to 301)
[2023-05-13 16:55:47,913] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Populating segment label to C1
[2023-05-13 16:55:48,102] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:87) - Saved segmentation as /tmp/tmpl8kvkdb7.dcm
[2023-05-13 16:55:48,111] [89037] [MainThread] [INFO] (monailabel.utils.others.generic:89) - Return code: 0
[2023-05-13 16:55:48,111] [89037] [MainThread] [INFO] (monailabel.datastore.utils.convert:170) - nifti_to_dicom_seg latency : 3.279916763305664 (sec)
[2023-05-13 16:55:48,221] [89037] [MainThread] [INFO] (dicomweb_client.web:2711) - store instances
[2023-05-13 16:55:48,293] [89037] [MainThread] [INFO] (dicomweb_client.web:1570) - store data in chunks using chunked transfer encoding
[2023-05-13 16:56:18,354] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - ISO_IR 100
[2023-05-13 16:56:18,354] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-05-13 16:56:18,354] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:122) - []
[2023-05-13 16:56:18,354] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:128) - Series Instance UID: 
[2023-05-13 16:56:18,355] [89037] [MainThread] [INFO] (monailabel.datastore.utils.dicom:130) - Time to upload: 30.242475271224976 (sec)
[2023-05-13 16:56:18,360] [89037] [MainThread] [INFO] (monailabel.datastore.local:485) - Saving Label for Image: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423; Tag: final; Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [221.33999999999997, 84.66000000000001, 84.66000000000001, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'C1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C1', 'description': ''}, {'id': '0+2', 'labelmapIndex': 0, 'segmentIndex': 2, 'color': [77.52, 228.48, 121.54999999999998, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'C2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C2', 'description': ''}, {'id': '0+3', 'labelmapIndex': 0, 'segmentIndex': 3, 'color': [166.76999999999995, 70.37999999999998, 235.62, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'C3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C3', 'description': ''}, {'id': '0+4', 'labelmapIndex': 0, 'segmentIndex': 4, 'color': [189.72, 180.54, 116.27999999999997, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 4, 'SegmentLabel': 'C4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C4', 'description': ''}, {'id': '0+5', 'labelmapIndex': 0, 'segmentIndex': 5, 'color': [109.13999999999999, 182.24000000000004, 196.86, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 5, 'SegmentLabel': 'C5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C5', 'description': ''}, {'id': '0+6', 'labelmapIndex': 0, 'segmentIndex': 6, 'color': [204, 101.99999999999997, 157.25000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 6, 'SegmentLabel': 'C6', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C6', 'description': ''}, {'id': '0+7', 'labelmapIndex': 0, 'segmentIndex': 7, 'color': [123.92999999999998, 211.14000000000001, 94.85999999999997, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 7, 'SegmentLabel': 'C7', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C7', 'description': ''}, {'id': '0+8', 'labelmapIndex': 0, 'segmentIndex': 8, 'color': [93.15999999999998, 87.71999999999996, 218.28000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 8, 'SegmentLabel': 'Th1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th1', 'description': ''}, {'id': '0+9', 'labelmapIndex': 0, 'segmentIndex': 9, 'color': [225.42000000000004, 128.85999999999996, 80.57999999999994, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 9, 'SegmentLabel': 'Th2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th2', 'description': ''}, {'id': '0+10', 'labelmapIndex': 0, 'segmentIndex': 10, 'color': [73.43999999999994, 232.56000000000003, 172.89000000000001, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 10, 'SegmentLabel': 'Th3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th3', 'description': ''}, {'id': '0+11', 'labelmapIndex': 0, 'segmentIndex': 11, 'color': [181.05000000000004, 119.33999999999993, 186.66000000000005, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 11, 'SegmentLabel': 'Th4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th4', 'description': ''}, {'id': '0+12', 'labelmapIndex': 0, 'segmentIndex': 12, 'color': [176.80000000000004, 193.80000000000007, 112.19999999999993, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 12, 'SegmentLabel': 'Th5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th5', 'description': ''}, {'id': '0+13', 'labelmapIndex': 0, 'segmentIndex': 13, 'color': [105.05999999999992, 153, 200.94000000000005, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 13, 'SegmentLabel': 'Th6', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th6', 'description': ''}, {'id': '0+14', 'labelmapIndex': 0, 'segmentIndex': 14, 'color': [208.08000000000007, 97.91999999999993, 120.86999999999992, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 14, 'SegmentLabel': 'Th7', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th7', 'description': ''}, {'id': '0+15', 'labelmapIndex': 0, 'segmentIndex': 15, 'color': [90.77999999999994, 215.22000000000006, 101.14999999999998, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 15, 'SegmentLabel': 'Th8', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th8', 'description': ''}, {'id': '0+16', 'labelmapIndex': 0, 'segmentIndex': 16, 'color': [135.65999999999997, 83.63999999999993, 222.36000000000004, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 16, 'SegmentLabel': 'Th9', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th9', 'description': ''}, {'id': '0+17', 'labelmapIndex': 0, 'segmentIndex': 17, 'color': [229.50000000000006, 178.50000000000003, 76.49999999999993, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 17, 'SegmentLabel': 'Th10', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th10', 'description': ''}, {'id': '0+18', 'labelmapIndex': 0, 'segmentIndex': 18, 'color': [122.3999999999999, 183.60000000000008, 181.05000000000007, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 18, 'SegmentLabel': 'Th11', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th11', 'description': ''}, {'id': '0+19', 'labelmapIndex': 0, 'segmentIndex': 19, 'color': [190.74000000000007, 115.2599999999999, 171.87000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 19, 'SegmentLabel': 'Th12', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th12', 'description': ''}, {'id': '0+20', 'labelmapIndex': 0, 'segmentIndex': 20, 'color': [149.26, 197.88000000000005, 108.1199999999999, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 20, 'SegmentLabel': 'L1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L1', 'description': ''}, {'id': '0+21', 'labelmapIndex': 0, 'segmentIndex': 21, 'color': [100.97999999999992, 118.31999999999994, 205.02000000000007, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 21, 'SegmentLabel': 'L2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L2', 'description': ''}, {'id': '0+22', 'labelmapIndex': 0, 'segmentIndex': 22, 'color': [212.16000000000008, 108.62999999999992, 93.83999999999992, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 22, 'SegmentLabel': 'L3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L3', 'description': ''}, {'id': '0+23', 'labelmapIndex': 0, 'segmentIndex': 23, 'color': [86.6999999999999, 219.30000000000007, 141.94999999999996, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 23, 'SegmentLabel': 'L4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L4', 'description': ''}, {'id': '0+24', 'labelmapIndex': 0, 'segmentIndex': 24, 'color': [183.6, 79.5599999999999, 226.44000000000008, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 24, 'SegmentLabel': 'L5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L5', 'description': ''}], 'SeriesInstanceUID': '', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408'}
[2023-05-13 16:56:18,360] [89037] [MainThread] [INFO] (monailabel.datastore.local:493) - Adding Label: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => final => /tmp/tmp6engzpx6.nii.gz
[2023-05-13 16:56:18,368] [89037] [MainThread] [INFO] (monailabel.datastore.local:509) - Label Info: {'label_info': [{'id': '0+1', 'labelmapIndex': 0, 'segmentIndex': 1, 'color': [221.33999999999997, 84.66000000000001, 84.66000000000001, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 1, 'SegmentLabel': 'C1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C1', 'description': ''}, {'id': '0+2', 'labelmapIndex': 0, 'segmentIndex': 2, 'color': [77.52, 228.48, 121.54999999999998, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 2, 'SegmentLabel': 'C2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C2', 'description': ''}, {'id': '0+3', 'labelmapIndex': 0, 'segmentIndex': 3, 'color': [166.76999999999995, 70.37999999999998, 235.62, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 3, 'SegmentLabel': 'C3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C3', 'description': ''}, {'id': '0+4', 'labelmapIndex': 0, 'segmentIndex': 4, 'color': [189.72, 180.54, 116.27999999999997, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 4, 'SegmentLabel': 'C4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C4', 'description': ''}, {'id': '0+5', 'labelmapIndex': 0, 'segmentIndex': 5, 'color': [109.13999999999999, 182.24000000000004, 196.86, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 5, 'SegmentLabel': 'C5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C5', 'description': ''}, {'id': '0+6', 'labelmapIndex': 0, 'segmentIndex': 6, 'color': [204, 101.99999999999997, 157.25000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 6, 'SegmentLabel': 'C6', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C6', 'description': ''}, {'id': '0+7', 'labelmapIndex': 0, 'segmentIndex': 7, 'color': [123.92999999999998, 211.14000000000001, 94.85999999999997, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 7, 'SegmentLabel': 'C7', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'C7', 'description': ''}, {'id': '0+8', 'labelmapIndex': 0, 'segmentIndex': 8, 'color': [93.15999999999998, 87.71999999999996, 218.28000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 8, 'SegmentLabel': 'Th1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th1', 'description': ''}, {'id': '0+9', 'labelmapIndex': 0, 'segmentIndex': 9, 'color': [225.42000000000004, 128.85999999999996, 80.57999999999994, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 9, 'SegmentLabel': 'Th2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th2', 'description': ''}, {'id': '0+10', 'labelmapIndex': 0, 'segmentIndex': 10, 'color': [73.43999999999994, 232.56000000000003, 172.89000000000001, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 10, 'SegmentLabel': 'Th3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th3', 'description': ''}, {'id': '0+11', 'labelmapIndex': 0, 'segmentIndex': 11, 'color': [181.05000000000004, 119.33999999999993, 186.66000000000005, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 11, 'SegmentLabel': 'Th4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th4', 'description': ''}, {'id': '0+12', 'labelmapIndex': 0, 'segmentIndex': 12, 'color': [176.80000000000004, 193.80000000000007, 112.19999999999993, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 12, 'SegmentLabel': 'Th5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th5', 'description': ''}, {'id': '0+13', 'labelmapIndex': 0, 'segmentIndex': 13, 'color': [105.05999999999992, 153, 200.94000000000005, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 13, 'SegmentLabel': 'Th6', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th6', 'description': ''}, {'id': '0+14', 'labelmapIndex': 0, 'segmentIndex': 14, 'color': [208.08000000000007, 97.91999999999993, 120.86999999999992, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 14, 'SegmentLabel': 'Th7', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th7', 'description': ''}, {'id': '0+15', 'labelmapIndex': 0, 'segmentIndex': 15, 'color': [90.77999999999994, 215.22000000000006, 101.14999999999998, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 15, 'SegmentLabel': 'Th8', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th8', 'description': ''}, {'id': '0+16', 'labelmapIndex': 0, 'segmentIndex': 16, 'color': [135.65999999999997, 83.63999999999993, 222.36000000000004, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 16, 'SegmentLabel': 'Th9', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th9', 'description': ''}, {'id': '0+17', 'labelmapIndex': 0, 'segmentIndex': 17, 'color': [229.50000000000006, 178.50000000000003, 76.49999999999993, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 17, 'SegmentLabel': 'Th10', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th10', 'description': ''}, {'id': '0+18', 'labelmapIndex': 0, 'segmentIndex': 18, 'color': [122.3999999999999, 183.60000000000008, 181.05000000000007, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 18, 'SegmentLabel': 'Th11', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th11', 'description': ''}, {'id': '0+19', 'labelmapIndex': 0, 'segmentIndex': 19, 'color': [190.74000000000007, 115.2599999999999, 171.87000000000003, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 19, 'SegmentLabel': 'Th12', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'Th12', 'description': ''}, {'id': '0+20', 'labelmapIndex': 0, 'segmentIndex': 20, 'color': [149.26, 197.88000000000005, 108.1199999999999, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 20, 'SegmentLabel': 'L1', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L1', 'description': ''}, {'id': '0+21', 'labelmapIndex': 0, 'segmentIndex': 21, 'color': [100.97999999999992, 118.31999999999994, 205.02000000000007, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 21, 'SegmentLabel': 'L2', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L2', 'description': ''}, {'id': '0+22', 'labelmapIndex': 0, 'segmentIndex': 22, 'color': [212.16000000000008, 108.62999999999992, 93.83999999999992, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 22, 'SegmentLabel': 'L3', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L3', 'description': ''}, {'id': '0+23', 'labelmapIndex': 0, 'segmentIndex': 23, 'color': [86.6999999999999, 219.30000000000007, 141.94999999999996, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 23, 'SegmentLabel': 'L4', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L4', 'description': ''}, {'id': '0+24', 'labelmapIndex': 0, 'segmentIndex': 24, 'color': [183.6, 79.5599999999999, 226.44000000000008, 255], 'meta': {'SegmentedPropertyCategoryCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}, 'SegmentNumber': 24, 'SegmentLabel': 'L5', 'SegmentDescription': '', 'SegmentAlgorithmType': 'SEMIAUTOMATIC', 'SegmentAlgorithmName': 'MONAI', 'SegmentedPropertyTypeCodeSequence': {'CodeValue': 'T-D0050', 'CodingSchemeDesignator': 'SRT', 'CodeMeaning': 'Tissue'}}, 'name': 'L5', 'description': ''}], 'SeriesInstanceUID': '', 'Modality': 'CT', 'PatientID': '001', 'StudyInstanceUID': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273408', 'ts': 1683971778, 'name': '1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423.nii.gz'}
[2023-05-13 16:56:18,381] [89037] [MainThread] [INFO] (monailabel.datastore.dicom:209) - Save completed!
[2023-05-13 16:56:18,381] [89037] [MainThread] [INFO] (monailabel.interfaces.app:492) - New label saved for: 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423 => 1.2.826.0.1.3680043.8.274.1.1.225842493.107716.1676705083.273423
[2023-05-13 16:56:18,419] [89037] [Thread-1] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-14 09:54:34,832] [37001] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndcuong/Documents/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-14 09:54:34,902] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-14 09:54:34,914] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-14 09:54:34,915] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-14 09:54:34,916] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-14 09:54:34,919] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-14 09:54:34,920] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-14 09:54:34,921] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-14 09:54:34,921] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-14 09:54:34,922] [37001] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-14 09:54:34,922] [37001] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-14 09:54:34,922] [37001] [MainThread] [INFO] (monailabel.utils.others.generic:184) - Downloading resource: /home/ndcuong/Documents/KTTN/apps/radiology/model/pretrained_segmentation_spleen.pt from https://github.com/Project-MONAI/MONAILabel/releases/download/pretrained/radiology_segmentation_unet_spleen.pt
[2023-05-14 09:54:48,412] [37001] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-14 09:54:48,412] [37001] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-14 09:54:48,412] [37001] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-14 09:54:48,412] [37001] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-14 09:54:48,413] [37001] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndcuong/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-14 09:54:48,413] [37001] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-14 09:54:48,413] [37001] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-14 09:54:48,422] [37001] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-14 09:54:48,422] [37001] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-14 09:54:48,423] [37001] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fd7922f5640>
[2023-05-14 09:54:48,423] [37001] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fd7922f5640>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fd7922f5340>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fd792578bb0>}
[2023-05-14 09:54:48,423] [37001] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fd792578f70>
[2023-05-14 09:54:48,423] [37001] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndcuong/.cache/monailabel/sessions
[2023-05-14 09:54:48,423] [37001] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-14 09:54:48,423] [37001] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-14 09:54:48,424] [37001] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-14 09:54:48,424] [37001] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fd792247af0>
[2023-05-14 09:54:48,424] [37001] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-14 09:55:48,494] [37719] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndcuong/Documents/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-14 09:55:48,518] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-14 09:55:48,520] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-14 09:55:48,520] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-14 09:55:48,520] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-14 09:55:48,521] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-14 09:55:48,521] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-14 09:55:48,522] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-14 09:55:48,522] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-14 09:55:48,522] [37719] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-14 09:55:48,522] [37719] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-14 09:55:48,565] [37719] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-14 09:55:48,565] [37719] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-14 09:55:48,565] [37719] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-14 09:55:48,565] [37719] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-14 09:55:48,566] [37719] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndcuong/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-14 09:55:48,566] [37719] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-14 09:55:48,567] [37719] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-14 09:55:48,567] [37719] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-14 09:55:48,567] [37719] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-14 09:55:48,568] [37719] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f0bf84ab910>
[2023-05-14 09:55:48,568] [37719] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f0bf84ab910>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f0bf84ab8b0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f0bf84ca820>}
[2023-05-14 09:55:48,568] [37719] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f0bf84ca880>
[2023-05-14 09:55:48,568] [37719] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndcuong/.cache/monailabel/sessions
[2023-05-14 09:55:48,568] [37719] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-14 09:55:48,568] [37719] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-14 09:55:48,568] [37719] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-14 09:55:48,568] [37719] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f0bf84c7310>
[2023-05-14 09:55:48,569] [37719] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-14 09:58:28,498] [39087] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndcuong/Documents/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-14 09:58:28,520] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-14 09:58:28,523] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-14 09:58:28,523] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-14 09:58:28,523] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-14 09:58:28,524] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-14 09:58:28,524] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-14 09:58:28,524] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-14 09:58:28,524] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-14 09:58:28,524] [39087] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-14 09:58:28,525] [39087] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-14 09:58:28,548] [39087] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-14 09:58:28,548] [39087] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-14 09:58:28,548] [39087] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-14 09:58:28,548] [39087] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-14 09:58:28,548] [39087] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndcuong/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-14 09:58:28,548] [39087] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-14 09:58:28,548] [39087] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-14 09:58:28,549] [39087] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-14 09:58:28,549] [39087] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f5b68a64820>
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7f5b68a64820>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f5b68a647c0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f5b68a7f730>}
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7f5b68a7f790>
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndcuong/.cache/monailabel/sessions
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f5b68a7c310>
[2023-05-14 09:58:28,550] [39087] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2023-05-14 11:10:21,586] [39087] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndcuong/Documents/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-14 11:10:21,588] [39087] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndcuong/Documents/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-14 11:10:21,589] [39087] [MainThread] [INFO] (monailabel.endpoints.ohif:38) - /home/ndcuong/Documents/KTTN/monailabel/endpoints/static/ohif/index.html
[2023-05-14 11:42:10,095] [75117] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /home/ndcuong/Documents/KTTN/apps/radiology; studies: http://127.0.0.1:8042/dicom-web; conf: {'models': 'segmentation_spleen'}
[2023-05-14 11:42:10,124] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.MyApp'>
[2023-05-14 11:42:10,126] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation.Segmentation'>
[2023-05-14 11:42:10,127] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_vertebra.SegmentationVertebra'>
[2023-05-14 11:42:10,127] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_3d.Deepgrow3D'>
[2023-05-14 11:42:10,127] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.segmentation_spleen.SegmentationSpleen'>
[2023-05-14 11:42:10,128] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_spine.LocalizationSpine'>
[2023-05-14 11:42:10,128] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepedit.DeepEdit'>
[2023-05-14 11:42:10,128] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.localization_vertebra.LocalizationVertebra'>
[2023-05-14 11:42:10,128] [75117] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for TaskConfig Found: <class 'lib.configs.deepgrow_2d.Deepgrow2D'>
[2023-05-14 11:42:10,128] [75117] [MainThread] [INFO] (main:93) - +++ Adding Model: segmentation_spleen => lib.configs.segmentation_spleen.SegmentationSpleen
[2023-05-14 11:42:10,170] [75117] [MainThread] [INFO] (lib.configs.segmentation_spleen:75) - EPISTEMIC Enabled: False; Samples: 5
[2023-05-14 11:42:10,170] [75117] [MainThread] [INFO] (main:96) - +++ Using Models: ['segmentation_spleen']
[2023-05-14 11:42:10,170] [75117] [MainThread] [INFO] (monailabel.interfaces.app:134) - Init Datastore for: http://127.0.0.1:8042/dicom-web
[2023-05-14 11:42:10,170] [75117] [MainThread] [INFO] (monailabel.interfaces.app:155) - Using DICOM WEB: http://127.0.0.1:8042/dicom-web
[2023-05-14 11:42:10,171] [75117] [MainThread] [INFO] (monailabel.datastore.dicom:62) - DICOMWeb Datastore (cache) Path: /home/ndcuong/.cache/monailabel/dicom/488fca1f7f3f98331f6f7756beca0d35; FetchByFrame: False
[2023-05-14 11:42:10,171] [75117] [MainThread] [INFO] (monailabel.datastore.dicom:63) - DICOMWeb Convert To Nifti: True
[2023-05-14 11:42:10,171] [75117] [MainThread] [INFO] (monailabel.datastore.local:129) - Auto Reload: True; Extensions: ('*.nii.gz', '*.nii')
[2023-05-14 11:42:10,172] [75117] [MainThread] [INFO] (monailabel.datastore.local:576) - Invalidate count: 0
[2023-05-14 11:42:10,172] [75117] [MainThread] [INFO] (monailabel.datastore.local:150) - Start observing external modifications on datastore (AUTO RELOAD)
[2023-05-14 11:42:10,172] [75117] [MainThread] [INFO] (main:126) - +++ Adding Inferer:: segmentation_spleen => <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fc1af0f5c40>
[2023-05-14 11:42:10,172] [75117] [MainThread] [INFO] (main:191) - {'segmentation_spleen': <lib.infers.segmentation_spleen.SegmentationSpleen object at 0x7fc1af0f5c40>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fc1af0f5be0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fc1af121b50>}
[2023-05-14 11:42:10,172] [75117] [MainThread] [INFO] (main:206) - +++ Adding Trainer:: segmentation_spleen => <lib.trainers.segmentation_spleen.SegmentationSpleen object at 0x7fc1af121bb0>
[2023-05-14 11:42:10,173] [75117] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /home/ndcuong/.cache/monailabel/sessions
[2023-05-14 11:42:10,173] [75117] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2023-05-14 11:42:10,173] [75117] [MainThread] [INFO] (monailabel.interfaces.app:468) - App Init - completed
[2023-05-14 11:42:10,173] [75117] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2023-05-14 11:42:10,173] [75117] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fc1af11e310>
[2023-05-14 11:42:10,173] [75117] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
